import{h as Qt,i as Jt,r as D,p as es,d as ne,j as f,R as fe,m as q,e as ts,f as ht,A as Qe,c as ss,X as is,L as rs}from"./index-D9KH-9ID.js";import{d as G,aC as Be,aF as ce,aQ as ns,aR as as,aS as os,aB as ls,at as ve,x as de,aT as cs,C as Te,y as Le,aj as Ot,aU as be,aV as rt,ax as Pt,aW as kt,ar as Oe,O as hs,M as Fe,aX as Ce,D as De,S as ke,ad as us,aG as nt,aY as $,H as Ut,a9 as Gt,R as ds,P as fs,aZ as ps,X as Ht,B as Je,ao as at,ai as jt,ap as Vt,a_ as vs,aK as ms,aO as gs,aw as xs,al as ys,E as ze,av as bs,a$ as ws,b0 as ut,as as $e,b1 as Ne,b2 as Ss,Z as _s,b3 as Es,aP as Ee}from"./DecryptedText-DmLC_geR.js";function Ms(){!Qt.current&&Jt();const[t]=D.useState(es.current);return t}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=ne("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=ne("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=ne("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=ne("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=ne("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=ne("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=ne("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=ne("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=ne("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=ne("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);function Me(t){let e=t[0],s=t[1],i=t[2];return Math.sqrt(e*e+s*s+i*i)}function et(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Bs(t,e,s,i){return t[0]=e,t[1]=s,t[2]=i,t}function ft(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t}function pt(t,e,s){return t[0]=e[0]-s[0],t[1]=e[1]-s[1],t[2]=e[2]-s[2],t}function Ls(t,e,s){return t[0]=e[0]*s[0],t[1]=e[1]*s[1],t[2]=e[2]*s[2],t}function Os(t,e,s){return t[0]=e[0]/s[0],t[1]=e[1]/s[1],t[2]=e[2]/s[2],t}function We(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function Ps(t,e){let s=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(s*s+i*i+r*r)}function ks(t,e){let s=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return s*s+i*i+r*r}function vt(t){let e=t[0],s=t[1],i=t[2];return e*e+s*s+i*i}function Us(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Gs(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function tt(t,e){let s=e[0],i=e[1],r=e[2],n=s*s+i*i+r*r;return n>0&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function $t(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function mt(t,e,s){let i=e[0],r=e[1],n=e[2],a=s[0],l=s[1],o=s[2];return t[0]=r*o-n*l,t[1]=n*a-i*o,t[2]=i*l-r*a,t}function Hs(t,e,s,i){let r=e[0],n=e[1],a=e[2];return t[0]=r+i*(s[0]-r),t[1]=n+i*(s[1]-n),t[2]=a+i*(s[2]-a),t}function js(t,e,s,i,r){const n=Math.exp(-i*r);let a=e[0],l=e[1],o=e[2];return t[0]=s[0]+(a-s[0])*n,t[1]=s[1]+(l-s[1])*n,t[2]=s[2]+(o-s[2])*n,t}function Vs(t,e,s){let i=e[0],r=e[1],n=e[2],a=s[3]*i+s[7]*r+s[11]*n+s[15];return a=a||1,t[0]=(s[0]*i+s[4]*r+s[8]*n+s[12])/a,t[1]=(s[1]*i+s[5]*r+s[9]*n+s[13])/a,t[2]=(s[2]*i+s[6]*r+s[10]*n+s[14])/a,t}function $s(t,e,s){let i=e[0],r=e[1],n=e[2],a=s[3]*i+s[7]*r+s[11]*n+s[15];return a=a||1,t[0]=(s[0]*i+s[4]*r+s[8]*n)/a,t[1]=(s[1]*i+s[5]*r+s[9]*n)/a,t[2]=(s[2]*i+s[6]*r+s[10]*n)/a,t}function Ws(t,e,s){let i=e[0],r=e[1],n=e[2];return t[0]=i*s[0]+r*s[3]+n*s[6],t[1]=i*s[1]+r*s[4]+n*s[7],t[2]=i*s[2]+r*s[5]+n*s[8],t}function qs(t,e,s){let i=e[0],r=e[1],n=e[2],a=s[0],l=s[1],o=s[2],c=s[3],h=l*n-o*r,d=o*i-a*n,v=a*r-l*i,p=l*v-o*d,m=o*h-a*v,g=a*d-l*h,x=c*2;return h*=x,d*=x,v*=x,p*=2,m*=2,g*=2,t[0]=i+h+p,t[1]=r+d+m,t[2]=n+v+g,t}const Xs=function(){const t=[0,0,0],e=[0,0,0];return function(s,i){et(t,s),et(e,i),tt(t,t),tt(e,e);let r=$t(t,e);return r>1?0:r<-1?Math.PI:Math.acos(r)}}();function Ys(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}class se extends Array{constructor(e=0,s=e,i=e){return super(e,s,i),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this[0]=e}set y(e){this[1]=e}set z(e){this[2]=e}set(e,s=e,i=e){return e.length?this.copy(e):(Bs(this,e,s,i),this)}copy(e){return et(this,e),this}add(e,s){return s?ft(this,e,s):ft(this,this,e),this}sub(e,s){return s?pt(this,e,s):pt(this,this,e),this}multiply(e){return e.length?Ls(this,this,e):We(this,this,e),this}divide(e){return e.length?Os(this,this,e):We(this,this,1/e),this}inverse(e=this){return Gs(this,e),this}len(){return Me(this)}distance(e){return e?Ps(this,e):Me(this)}squaredLen(){return vt(this)}squaredDistance(e){return e?ks(this,e):vt(this)}negate(e=this){return Us(this,e),this}cross(e,s){return s?mt(this,e,s):mt(this,this,e),this}scale(e){return We(this,this,e),this}normalize(){return tt(this,this),this}dot(e){return $t(this,e)}equals(e){return Ys(this,e)}applyMatrix3(e){return Ws(this,this,e),this}applyMatrix4(e){return Vs(this,this,e),this}scaleRotateMatrix4(e){return $s(this,this,e),this}applyQuaternion(e){return qs(this,this,e),this}angle(e){return Xs(this,e)}lerp(e,s){return Hs(this,this,e,s),this}smoothLerp(e,s,i){return js(this,this,e,s,i),this}clone(){return new se(this[0],this[1],this[2])}fromArray(e,s=0){return this[0]=e[s],this[1]=e[s+1],this[2]=e[s+2],this}toArray(e=[],s=0){return e[s]=this[0],e[s+1]=this[1],e[s+2]=this[2],e}transformDirection(e){const s=this[0],i=this[1],r=this[2];return this[0]=e[0]*s+e[4]*i+e[8]*r,this[1]=e[1]*s+e[5]*i+e[9]*r,this[2]=e[2]*s+e[6]*i+e[10]*r,this.normalize()}}const gt=new se;let Zs=1,Ks=1,xt=!1;class Qs{constructor(e,s={}){e.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=e,this.attributes=s,this.id=Zs++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let i in s)this.addAttribute(i,s[i])}addAttribute(e,s){if(this.attributes[e]=s,s.id=Ks++,s.size=s.size||1,s.type=s.type||(s.data.constructor===Float32Array?this.gl.FLOAT:s.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),s.target=e==="index"?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,s.normalized=s.normalized||!1,s.stride=s.stride||0,s.offset=s.offset||0,s.count=s.count||(s.stride?s.data.byteLength/s.stride:s.data.length/s.size),s.divisor=s.instanced||0,s.needsUpdate=!1,s.usage=s.usage||this.gl.STATIC_DRAW,s.buffer||this.updateAttribute(s),s.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==s.count*s.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,s.count*s.divisor);this.instancedCount=s.count*s.divisor}else e==="index"?this.drawRange.count=s.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,s.count))}updateAttribute(e){const s=!e.buffer;s&&(e.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==e.buffer&&(this.gl.bindBuffer(e.target,e.buffer),this.glState.boundBuffer=e.buffer),s?this.gl.bufferData(e.target,e.data,e.usage):this.gl.bufferSubData(e.target,0,e.data),e.needsUpdate=!1}setIndex(e){this.addAttribute("index",e)}setDrawRange(e,s){this.drawRange.start=e,this.drawRange.count=s}setInstancedCount(e){this.instancedCount=e}createVAO(e){this.VAOs[e.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.bindAttributes(e)}bindAttributes(e){e.attributeLocations.forEach((s,{name:i,type:r})=>{if(!this.attributes[i]){console.warn(`active attribute ${i} not being supplied`);return}const n=this.attributes[i];this.gl.bindBuffer(n.target,n.buffer),this.glState.boundBuffer=n.buffer;let a=1;r===35674&&(a=2),r===35675&&(a=3),r===35676&&(a=4);const l=n.size/a,o=a===1?0:a*a*4,c=a===1?0:a*4;for(let h=0;h<a;h++)this.gl.vertexAttribPointer(s+h,l,n.type,n.normalized,n.stride+o,n.offset+h*c),this.gl.enableVertexAttribArray(s+h),this.gl.renderer.vertexAttribDivisor(s+h,n.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:e,mode:s=this.gl.TRIANGLES}){var r;this.gl.renderer.currentGeometry!==`${this.id}_${e.attributeOrder}`&&(this.VAOs[e.attributeOrder]||this.createVAO(e),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${e.attributeOrder}`),e.attributeLocations.forEach((n,{name:a})=>{const l=this.attributes[a];l.needsUpdate&&this.updateAttribute(l)});let i=2;((r=this.attributes.index)==null?void 0:r.type)===this.gl.UNSIGNED_INT&&(i=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(s,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*i,this.instancedCount):this.gl.renderer.drawArraysInstanced(s,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(s,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*i):this.gl.drawArrays(s,this.drawRange.start,this.drawRange.count)}getPosition(){const e=this.attributes.position;if(e.data)return e;if(!xt)return console.warn("No position buffer data found to compute bounds"),xt=!0}computeBoundingBox(e){e||(e=this.getPosition());const s=e.data,i=e.size;this.bounds||(this.bounds={min:new se,max:new se,center:new se,scale:new se,radius:1/0});const r=this.bounds.min,n=this.bounds.max,a=this.bounds.center,l=this.bounds.scale;r.set(1/0),n.set(-1/0);for(let o=0,c=s.length;o<c;o+=i){const h=s[o],d=s[o+1],v=s[o+2];r.x=Math.min(h,r.x),r.y=Math.min(d,r.y),r.z=Math.min(v,r.z),n.x=Math.max(h,n.x),n.y=Math.max(d,n.y),n.z=Math.max(v,n.z)}l.sub(n,r),a.add(r,n).divide(2)}computeBoundingSphere(e){e||(e=this.getPosition());const s=e.data,i=e.size;this.bounds||this.computeBoundingBox(e);let r=0;for(let n=0,a=s.length;n<a;n+=i)gt.fromArray(s,n),r=Math.max(r,this.bounds.center.squaredDistance(gt));this.bounds.radius=Math.sqrt(r)}remove(){for(let e in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[e]),delete this.VAOs[e];for(let e in this.attributes)this.gl.deleteBuffer(this.attributes[e].buffer),delete this.attributes[e]}}let Js=1;const yt={};class ei{constructor(e,{vertex:s,fragment:i,uniforms:r={},transparent:n=!1,cullFace:a=e.BACK,frontFace:l=e.CCW,depthTest:o=!0,depthWrite:c=!0,depthFunc:h=e.LEQUAL}={}){e.canvas||console.error("gl not passed as first argument to Program"),this.gl=e,this.uniforms=r,this.id=Js++,s||console.warn("vertex shader not supplied"),i||console.warn("fragment shader not supplied"),this.transparent=n,this.cullFace=a,this.frontFace=l,this.depthTest=o,this.depthWrite=c,this.depthFunc=h,this.blendFunc={},this.blendEquation={},this.stencilFunc={},this.stencilOp={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this.vertexShader=e.createShader(e.VERTEX_SHADER),this.fragmentShader=e.createShader(e.FRAGMENT_SHADER),this.program=e.createProgram(),e.attachShader(this.program,this.vertexShader),e.attachShader(this.program,this.fragmentShader),this.setShaders({vertex:s,fragment:i})}setShaders({vertex:e,fragment:s}){if(e&&(this.gl.shaderSource(this.vertexShader,e),this.gl.compileShader(this.vertexShader),this.gl.getShaderInfoLog(this.vertexShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.vertexShader)}
Vertex Shader
${bt(e)}`)),s&&(this.gl.shaderSource(this.fragmentShader,s),this.gl.compileShader(this.fragmentShader),this.gl.getShaderInfoLog(this.fragmentShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.fragmentShader)}
Fragment Shader
${bt(s)}`)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.warn(this.gl.getProgramInfoLog(this.program));this.uniformLocations=new Map;let i=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let a=0;a<i;a++){let l=this.gl.getActiveUniform(this.program,a);this.uniformLocations.set(l,this.gl.getUniformLocation(this.program,l.name));const o=l.name.match(/(\w+)/g);l.uniformName=o[0],l.nameComponents=o.slice(1)}this.attributeLocations=new Map;const r=[],n=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let a=0;a<n;a++){const l=this.gl.getActiveAttrib(this.program,a),o=this.gl.getAttribLocation(this.program,l.name);o!==-1&&(r[o]=l.name,this.attributeLocations.set(l,o))}this.attributeOrder=r.join("")}setBlendFunc(e,s,i,r){this.blendFunc.src=e,this.blendFunc.dst=s,this.blendFunc.srcAlpha=i,this.blendFunc.dstAlpha=r,e&&(this.transparent=!0)}setBlendEquation(e,s){this.blendEquation.modeRGB=e,this.blendEquation.modeAlpha=s}setStencilFunc(e,s,i){this.stencilRef=s,this.stencilFunc.func=e,this.stencilFunc.ref=s,this.stencilFunc.mask=i}setStencilOp(e,s,i){this.stencilOp.stencilFail=e,this.stencilOp.depthFail=s,this.stencilOp.depthPass=i}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha),this.stencilFunc.func||this.stencilOp.stencilFail?this.gl.renderer.enable(this.gl.STENCIL_TEST):this.gl.renderer.disable(this.gl.STENCIL_TEST),this.gl.renderer.setStencilFunc(this.stencilFunc.func,this.stencilFunc.ref,this.stencilFunc.mask),this.gl.renderer.setStencilOp(this.stencilOp.stencilFail,this.stencilOp.depthFail,this.stencilOp.depthPass)}use({flipFaces:e=!1}={}){let s=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((r,n)=>{let a=this.uniforms[n.uniformName];for(const l of n.nameComponents){if(!a)break;if(l in a)a=a[l];else{if(Array.isArray(a.value))break;a=void 0;break}}if(!a)return wt(`Active uniform ${n.name} has not been supplied`);if(a&&a.value===void 0)return wt(`${n.name} uniform is missing a value parameter`);if(a.value.texture)return s=s+1,a.value.update(s),qe(this.gl,n.type,r,s);if(a.value.length&&a.value[0].texture){const l=[];return a.value.forEach(o=>{s=s+1,o.update(s),l.push(s)}),qe(this.gl,n.type,r,l)}qe(this.gl,n.type,r,a.value)}),this.applyState(),e&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function qe(t,e,s,i){i=i.length?ti(i):i;const r=t.renderer.state.uniformLocations.get(s);if(i.length)if(r===void 0||r.length!==i.length)t.renderer.state.uniformLocations.set(s,i.slice(0));else{if(si(r,i))return;r.set?r.set(i):ii(r,i),t.renderer.state.uniformLocations.set(s,r)}else{if(r===i)return;t.renderer.state.uniformLocations.set(s,i)}switch(e){case 5126:return i.length?t.uniform1fv(s,i):t.uniform1f(s,i);case 35664:return t.uniform2fv(s,i);case 35665:return t.uniform3fv(s,i);case 35666:return t.uniform4fv(s,i);case 35670:case 5124:case 35678:case 36306:case 35680:case 36289:return i.length?t.uniform1iv(s,i):t.uniform1i(s,i);case 35671:case 35667:return t.uniform2iv(s,i);case 35672:case 35668:return t.uniform3iv(s,i);case 35673:case 35669:return t.uniform4iv(s,i);case 35674:return t.uniformMatrix2fv(s,!1,i);case 35675:return t.uniformMatrix3fv(s,!1,i);case 35676:return t.uniformMatrix4fv(s,!1,i)}}function bt(t){let e=t.split(`
`);for(let s=0;s<e.length;s++)e[s]=s+1+": "+e[s];return e.join(`
`)}function ti(t){const e=t.length,s=t[0].length;if(s===void 0)return t;const i=e*s;let r=yt[i];r||(yt[i]=r=new Float32Array(i));for(let n=0;n<e;n++)r.set(t[n],n*s);return r}function si(t,e){if(t.length!==e.length)return!1;for(let s=0,i=t.length;s<i;s++)if(t[s]!==e[s])return!1;return!0}function ii(t,e){for(let s=0,i=t.length;s<i;s++)t[s]=e[s]}let Xe=0;function wt(t){Xe>100||(console.warn(t),Xe++,Xe>100&&console.warn("More than 100 program warnings - stopping logs."))}const Ye=new se;let ri=1;class ni{constructor({canvas:e=document.createElement("canvas"),width:s=300,height:i=150,dpr:r=1,alpha:n=!1,depth:a=!0,stencil:l=!1,antialias:o=!1,premultipliedAlpha:c=!1,preserveDrawingBuffer:h=!1,powerPreference:d="default",autoClear:v=!0,webgl:p=2}={}){const m={alpha:n,depth:a,stencil:l,antialias:o,premultipliedAlpha:c,preserveDrawingBuffer:h,powerPreference:d};this.dpr=r,this.alpha=n,this.color=!0,this.depth=a,this.stencil=l,this.premultipliedAlpha=c,this.autoClear=v,this.id=ri++,p===2&&(this.gl=e.getContext("webgl2",m)),this.isWebgl2=!!this.gl,this.gl||(this.gl=e.getContext("webgl",m)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(s,i),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=!1,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LEQUAL,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(e,s){this.width=e,this.height=s,this.gl.canvas.width=e*this.dpr,this.gl.canvas.height=s*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:e+"px",height:s+"px"})}setViewport(e,s,i=0,r=0){this.state.viewport.width===e&&this.state.viewport.height===s||(this.state.viewport.width=e,this.state.viewport.height=s,this.state.viewport.x=i,this.state.viewport.y=r,this.gl.viewport(i,r,e,s))}setScissor(e,s,i=0,r=0){this.gl.scissor(i,r,e,s)}enable(e){this.state[e]!==!0&&(this.gl.enable(e),this.state[e]=!0)}disable(e){this.state[e]!==!1&&(this.gl.disable(e),this.state[e]=!1)}setBlendFunc(e,s,i,r){this.state.blendFunc.src===e&&this.state.blendFunc.dst===s&&this.state.blendFunc.srcAlpha===i&&this.state.blendFunc.dstAlpha===r||(this.state.blendFunc.src=e,this.state.blendFunc.dst=s,this.state.blendFunc.srcAlpha=i,this.state.blendFunc.dstAlpha=r,i!==void 0?this.gl.blendFuncSeparate(e,s,i,r):this.gl.blendFunc(e,s))}setBlendEquation(e,s){e=e||this.gl.FUNC_ADD,!(this.state.blendEquation.modeRGB===e&&this.state.blendEquation.modeAlpha===s)&&(this.state.blendEquation.modeRGB=e,this.state.blendEquation.modeAlpha=s,s!==void 0?this.gl.blendEquationSeparate(e,s):this.gl.blendEquation(e))}setCullFace(e){this.state.cullFace!==e&&(this.state.cullFace=e,this.gl.cullFace(e))}setFrontFace(e){this.state.frontFace!==e&&(this.state.frontFace=e,this.gl.frontFace(e))}setDepthMask(e){this.state.depthMask!==e&&(this.state.depthMask=e,this.gl.depthMask(e))}setDepthFunc(e){this.state.depthFunc!==e&&(this.state.depthFunc=e,this.gl.depthFunc(e))}setStencilMask(e){this.state.stencilMask!==e&&(this.state.stencilMask=e,this.gl.stencilMask(e))}setStencilFunc(e,s,i){this.state.stencilFunc===e&&this.state.stencilRef===s&&this.state.stencilFuncMask===i||(this.state.stencilFunc=e||this.gl.ALWAYS,this.state.stencilRef=s||0,this.state.stencilFuncMask=i||0,this.gl.stencilFunc(e||this.gl.ALWAYS,s||0,i||0))}setStencilOp(e,s,i){this.state.stencilFail===e&&this.state.stencilDepthFail===s&&this.state.stencilDepthPass===i||(this.state.stencilFail=e,this.state.stencilDepthFail=s,this.state.stencilDepthPass=i,this.gl.stencilOp(e,s,i))}activeTexture(e){this.state.activeTextureUnit!==e&&(this.state.activeTextureUnit=e,this.gl.activeTexture(this.gl.TEXTURE0+e))}bindFramebuffer({target:e=this.gl.FRAMEBUFFER,buffer:s=null}={}){this.state.framebuffer!==s&&(this.state.framebuffer=s,this.gl.bindFramebuffer(e,s))}getExtension(e,s,i){return s&&this.gl[s]?this.gl[s].bind(this.gl):(this.extensions[e]||(this.extensions[e]=this.gl.getExtension(e)),s?this.extensions[e]?this.extensions[e][i].bind(this.extensions[e]):null:this.extensions[e])}sortOpaque(e,s){return e.renderOrder!==s.renderOrder?e.renderOrder-s.renderOrder:e.program.id!==s.program.id?e.program.id-s.program.id:e.zDepth!==s.zDepth?e.zDepth-s.zDepth:s.id-e.id}sortTransparent(e,s){return e.renderOrder!==s.renderOrder?e.renderOrder-s.renderOrder:e.zDepth!==s.zDepth?s.zDepth-e.zDepth:s.id-e.id}sortUI(e,s){return e.renderOrder!==s.renderOrder?e.renderOrder-s.renderOrder:e.program.id!==s.program.id?e.program.id-s.program.id:s.id-e.id}getRenderList({scene:e,camera:s,frustumCull:i,sort:r}){let n=[];if(s&&i&&s.updateFrustum(),e.traverse(a=>{if(!a.visible)return!0;a.draw&&(i&&a.frustumCulled&&s&&!s.frustumIntersectsMesh(a)||n.push(a))}),r){const a=[],l=[],o=[];n.forEach(c=>{c.program.transparent?c.program.depthTest?l.push(c):o.push(c):a.push(c),c.zDepth=0,!(c.renderOrder!==0||!c.program.depthTest||!s)&&(c.worldMatrix.getTranslation(Ye),Ye.applyMatrix4(s.projectionViewMatrix),c.zDepth=Ye.z)}),a.sort(this.sortOpaque),l.sort(this.sortTransparent),o.sort(this.sortUI),n=a.concat(l,o)}return n}render({scene:e,camera:s,target:i=null,update:r=!0,sort:n=!0,frustumCull:a=!0,clear:l}){i===null?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(i),this.setViewport(i.width,i.height)),(l||this.autoClear&&l!==!1)&&(this.depth&&(!i||i.depth)&&(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),(this.stencil||!i||i.stencil)&&(this.enable(this.gl.STENCIL_TEST),this.setStencilMask(255)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),r&&e.updateMatrixWorld(),s&&s.updateMatrixWorld(),this.getRenderList({scene:e,camera:s,frustumCull:a,sort:n}).forEach(c=>{c.draw({camera:s})})}}function ai(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function oi(t,e,s,i,r){return t[0]=e,t[1]=s,t[2]=i,t[3]=r,t}function li(t,e){let s=e[0],i=e[1],r=e[2],n=e[3],a=s*s+i*i+r*r+n*n;return a>0&&(a=1/Math.sqrt(a)),t[0]=s*a,t[1]=i*a,t[2]=r*a,t[3]=n*a,t}function ci(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function hi(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ui(t,e,s){s=s*.5;let i=Math.sin(s);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(s),t}function St(t,e,s){let i=e[0],r=e[1],n=e[2],a=e[3],l=s[0],o=s[1],c=s[2],h=s[3];return t[0]=i*h+a*l+r*c-n*o,t[1]=r*h+a*o+n*l-i*c,t[2]=n*h+a*c+i*o-r*l,t[3]=a*h-i*l-r*o-n*c,t}function di(t,e,s){s*=.5;let i=e[0],r=e[1],n=e[2],a=e[3],l=Math.sin(s),o=Math.cos(s);return t[0]=i*o+a*l,t[1]=r*o+n*l,t[2]=n*o-r*l,t[3]=a*o-i*l,t}function fi(t,e,s){s*=.5;let i=e[0],r=e[1],n=e[2],a=e[3],l=Math.sin(s),o=Math.cos(s);return t[0]=i*o-n*l,t[1]=r*o+a*l,t[2]=n*o+i*l,t[3]=a*o-r*l,t}function pi(t,e,s){s*=.5;let i=e[0],r=e[1],n=e[2],a=e[3],l=Math.sin(s),o=Math.cos(s);return t[0]=i*o+r*l,t[1]=r*o-i*l,t[2]=n*o+a*l,t[3]=a*o-n*l,t}function vi(t,e,s,i){let r=e[0],n=e[1],a=e[2],l=e[3],o=s[0],c=s[1],h=s[2],d=s[3],v,p,m,g,x;return p=r*o+n*c+a*h+l*d,p<0&&(p=-p,o=-o,c=-c,h=-h,d=-d),1-p>1e-6?(v=Math.acos(p),m=Math.sin(v),g=Math.sin((1-i)*v)/m,x=Math.sin(i*v)/m):(g=1-i,x=i),t[0]=g*r+x*o,t[1]=g*n+x*c,t[2]=g*a+x*h,t[3]=g*l+x*d,t}function mi(t,e){let s=e[0],i=e[1],r=e[2],n=e[3],a=s*s+i*i+r*r+n*n,l=a?1/a:0;return t[0]=-s*l,t[1]=-i*l,t[2]=-r*l,t[3]=n*l,t}function gi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function xi(t,e){let s=e[0]+e[4]+e[8],i;if(s>0)i=Math.sqrt(s+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[r*3+r]&&(r=2);let n=(r+1)%3,a=(r+2)%3;i=Math.sqrt(e[r*3+r]-e[n*3+n]-e[a*3+a]+1),t[r]=.5*i,i=.5/i,t[3]=(e[n*3+a]-e[a*3+n])*i,t[n]=(e[n*3+r]+e[r*3+n])*i,t[a]=(e[a*3+r]+e[r*3+a])*i}return t}function yi(t,e,s="YXZ"){let i=Math.sin(e[0]*.5),r=Math.cos(e[0]*.5),n=Math.sin(e[1]*.5),a=Math.cos(e[1]*.5),l=Math.sin(e[2]*.5),o=Math.cos(e[2]*.5);return s==="XYZ"?(t[0]=i*a*o+r*n*l,t[1]=r*n*o-i*a*l,t[2]=r*a*l+i*n*o,t[3]=r*a*o-i*n*l):s==="YXZ"?(t[0]=i*a*o+r*n*l,t[1]=r*n*o-i*a*l,t[2]=r*a*l-i*n*o,t[3]=r*a*o+i*n*l):s==="ZXY"?(t[0]=i*a*o-r*n*l,t[1]=r*n*o+i*a*l,t[2]=r*a*l+i*n*o,t[3]=r*a*o-i*n*l):s==="ZYX"?(t[0]=i*a*o-r*n*l,t[1]=r*n*o+i*a*l,t[2]=r*a*l-i*n*o,t[3]=r*a*o+i*n*l):s==="YZX"?(t[0]=i*a*o+r*n*l,t[1]=r*n*o+i*a*l,t[2]=r*a*l-i*n*o,t[3]=r*a*o-i*n*l):s==="XZY"&&(t[0]=i*a*o-r*n*l,t[1]=r*n*o-i*a*l,t[2]=r*a*l+i*n*o,t[3]=r*a*o+i*n*l),t}const bi=ai,wi=oi,Si=ci,_i=li;class Ei extends Array{constructor(e=0,s=0,i=0,r=1){super(e,s,i,r),this.onChange=()=>{},this._target=this;const n=["0","1","2","3"];return new Proxy(this,{set(a,l){const o=Reflect.set(...arguments);return o&&n.includes(l)&&a.onChange(),o}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set w(e){this._target[3]=e,this.onChange()}identity(){return hi(this._target),this.onChange(),this}set(e,s,i,r){return e.length?this.copy(e):(wi(this._target,e,s,i,r),this.onChange(),this)}rotateX(e){return di(this._target,this._target,e),this.onChange(),this}rotateY(e){return fi(this._target,this._target,e),this.onChange(),this}rotateZ(e){return pi(this._target,this._target,e),this.onChange(),this}inverse(e=this._target){return mi(this._target,e),this.onChange(),this}conjugate(e=this._target){return gi(this._target,e),this.onChange(),this}copy(e){return bi(this._target,e),this.onChange(),this}normalize(e=this._target){return _i(this._target,e),this.onChange(),this}multiply(e,s){return s?St(this._target,e,s):St(this._target,this._target,e),this.onChange(),this}dot(e){return Si(this._target,e)}fromMatrix3(e){return xi(this._target,e),this.onChange(),this}fromEuler(e,s){return yi(this._target,e,e.order),s||this.onChange(),this}fromAxisAngle(e,s){return ui(this._target,e,s),this.onChange(),this}slerp(e,s){return vi(this._target,this._target,e,s),this.onChange(),this}fromArray(e,s=0){return this._target[0]=e[s],this._target[1]=e[s+1],this._target[2]=e[s+2],this._target[3]=e[s+3],this.onChange(),this}toArray(e=[],s=0){return e[s]=this[0],e[s+1]=this[1],e[s+2]=this[2],e[s+3]=this[3],e}}const Mi=1e-6;function Ti(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ri(t,e,s,i,r,n,a,l,o,c,h,d,v,p,m,g,x){return t[0]=e,t[1]=s,t[2]=i,t[3]=r,t[4]=n,t[5]=a,t[6]=l,t[7]=o,t[8]=c,t[9]=h,t[10]=d,t[11]=v,t[12]=p,t[13]=m,t[14]=g,t[15]=x,t}function Ai(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ci(t,e){let s=e[0],i=e[1],r=e[2],n=e[3],a=e[4],l=e[5],o=e[6],c=e[7],h=e[8],d=e[9],v=e[10],p=e[11],m=e[12],g=e[13],x=e[14],b=e[15],S=s*l-i*a,y=s*o-r*a,w=s*c-n*a,T=i*o-r*l,E=i*c-n*l,O=r*c-n*o,C=h*g-d*m,N=h*x-v*m,R=h*b-p*m,z=d*x-v*g,I=d*b-p*g,k=v*b-p*x,M=S*k-y*I+w*z+T*R-E*N+O*C;return M?(M=1/M,t[0]=(l*k-o*I+c*z)*M,t[1]=(r*I-i*k-n*z)*M,t[2]=(g*O-x*E+b*T)*M,t[3]=(v*E-d*O-p*T)*M,t[4]=(o*R-a*k-c*N)*M,t[5]=(s*k-r*R+n*N)*M,t[6]=(x*w-m*O-b*y)*M,t[7]=(h*O-v*w+p*y)*M,t[8]=(a*I-l*R+c*C)*M,t[9]=(i*R-s*I-n*C)*M,t[10]=(m*E-g*w+b*S)*M,t[11]=(d*w-h*E-p*S)*M,t[12]=(l*N-a*z-o*C)*M,t[13]=(s*z-i*N+r*C)*M,t[14]=(g*y-m*T-x*S)*M,t[15]=(h*T-d*y+v*S)*M,t):null}function Wt(t){let e=t[0],s=t[1],i=t[2],r=t[3],n=t[4],a=t[5],l=t[6],o=t[7],c=t[8],h=t[9],d=t[10],v=t[11],p=t[12],m=t[13],g=t[14],x=t[15],b=e*a-s*n,S=e*l-i*n,y=e*o-r*n,w=s*l-i*a,T=s*o-r*a,E=i*o-r*l,O=c*m-h*p,C=c*g-d*p,N=c*x-v*p,R=h*g-d*m,z=h*x-v*m,I=d*x-v*g;return b*I-S*z+y*R+w*N-T*C+E*O}function _t(t,e,s){let i=e[0],r=e[1],n=e[2],a=e[3],l=e[4],o=e[5],c=e[6],h=e[7],d=e[8],v=e[9],p=e[10],m=e[11],g=e[12],x=e[13],b=e[14],S=e[15],y=s[0],w=s[1],T=s[2],E=s[3];return t[0]=y*i+w*l+T*d+E*g,t[1]=y*r+w*o+T*v+E*x,t[2]=y*n+w*c+T*p+E*b,t[3]=y*a+w*h+T*m+E*S,y=s[4],w=s[5],T=s[6],E=s[7],t[4]=y*i+w*l+T*d+E*g,t[5]=y*r+w*o+T*v+E*x,t[6]=y*n+w*c+T*p+E*b,t[7]=y*a+w*h+T*m+E*S,y=s[8],w=s[9],T=s[10],E=s[11],t[8]=y*i+w*l+T*d+E*g,t[9]=y*r+w*o+T*v+E*x,t[10]=y*n+w*c+T*p+E*b,t[11]=y*a+w*h+T*m+E*S,y=s[12],w=s[13],T=s[14],E=s[15],t[12]=y*i+w*l+T*d+E*g,t[13]=y*r+w*o+T*v+E*x,t[14]=y*n+w*c+T*p+E*b,t[15]=y*a+w*h+T*m+E*S,t}function Di(t,e,s){let i=s[0],r=s[1],n=s[2],a,l,o,c,h,d,v,p,m,g,x,b;return e===t?(t[12]=e[0]*i+e[4]*r+e[8]*n+e[12],t[13]=e[1]*i+e[5]*r+e[9]*n+e[13],t[14]=e[2]*i+e[6]*r+e[10]*n+e[14],t[15]=e[3]*i+e[7]*r+e[11]*n+e[15]):(a=e[0],l=e[1],o=e[2],c=e[3],h=e[4],d=e[5],v=e[6],p=e[7],m=e[8],g=e[9],x=e[10],b=e[11],t[0]=a,t[1]=l,t[2]=o,t[3]=c,t[4]=h,t[5]=d,t[6]=v,t[7]=p,t[8]=m,t[9]=g,t[10]=x,t[11]=b,t[12]=a*i+h*r+m*n+e[12],t[13]=l*i+d*r+g*n+e[13],t[14]=o*i+v*r+x*n+e[14],t[15]=c*i+p*r+b*n+e[15]),t}function zi(t,e,s){let i=s[0],r=s[1],n=s[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ni(t,e,s,i){let r=i[0],n=i[1],a=i[2],l=Math.hypot(r,n,a),o,c,h,d,v,p,m,g,x,b,S,y,w,T,E,O,C,N,R,z,I,k,M,Y;return Math.abs(l)<Mi?null:(l=1/l,r*=l,n*=l,a*=l,o=Math.sin(s),c=Math.cos(s),h=1-c,d=e[0],v=e[1],p=e[2],m=e[3],g=e[4],x=e[5],b=e[6],S=e[7],y=e[8],w=e[9],T=e[10],E=e[11],O=r*r*h+c,C=n*r*h+a*o,N=a*r*h-n*o,R=r*n*h-a*o,z=n*n*h+c,I=a*n*h+r*o,k=r*a*h+n*o,M=n*a*h-r*o,Y=a*a*h+c,t[0]=d*O+g*C+y*N,t[1]=v*O+x*C+w*N,t[2]=p*O+b*C+T*N,t[3]=m*O+S*C+E*N,t[4]=d*R+g*z+y*I,t[5]=v*R+x*z+w*I,t[6]=p*R+b*z+T*I,t[7]=m*R+S*z+E*I,t[8]=d*k+g*M+y*Y,t[9]=v*k+x*M+w*Y,t[10]=p*k+b*M+T*Y,t[11]=m*k+S*M+E*Y,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Fi(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function qt(t,e){let s=e[0],i=e[1],r=e[2],n=e[4],a=e[5],l=e[6],o=e[8],c=e[9],h=e[10];return t[0]=Math.hypot(s,i,r),t[1]=Math.hypot(n,a,l),t[2]=Math.hypot(o,c,h),t}function Ii(t){let e=t[0],s=t[1],i=t[2],r=t[4],n=t[5],a=t[6],l=t[8],o=t[9],c=t[10];const h=e*e+s*s+i*i,d=r*r+n*n+a*a,v=l*l+o*o+c*c;return Math.sqrt(Math.max(h,d,v))}const Xt=function(){const t=[1,1,1];return function(e,s){let i=t;qt(i,s);let r=1/i[0],n=1/i[1],a=1/i[2],l=s[0]*r,o=s[1]*n,c=s[2]*a,h=s[4]*r,d=s[5]*n,v=s[6]*a,p=s[8]*r,m=s[9]*n,g=s[10]*a,x=l+d+g,b=0;return x>0?(b=Math.sqrt(x+1)*2,e[3]=.25*b,e[0]=(v-m)/b,e[1]=(p-c)/b,e[2]=(o-h)/b):l>d&&l>g?(b=Math.sqrt(1+l-d-g)*2,e[3]=(v-m)/b,e[0]=.25*b,e[1]=(o+h)/b,e[2]=(p+c)/b):d>g?(b=Math.sqrt(1+d-l-g)*2,e[3]=(p-c)/b,e[0]=(o+h)/b,e[1]=.25*b,e[2]=(v+m)/b):(b=Math.sqrt(1+g-l-d)*2,e[3]=(o-h)/b,e[0]=(p+c)/b,e[1]=(v+m)/b,e[2]=.25*b),e}}();function Bi(t,e,s,i){let r=Me([t[0],t[1],t[2]]);const n=Me([t[4],t[5],t[6]]),a=Me([t[8],t[9],t[10]]);Wt(t)<0&&(r=-r),s[0]=t[12],s[1]=t[13],s[2]=t[14];const o=t.slice(),c=1/r,h=1/n,d=1/a;o[0]*=c,o[1]*=c,o[2]*=c,o[4]*=h,o[5]*=h,o[6]*=h,o[8]*=d,o[9]*=d,o[10]*=d,Xt(e,o),i[0]=r,i[1]=n,i[2]=a}function Li(t,e,s,i){const r=t,n=e[0],a=e[1],l=e[2],o=e[3],c=n+n,h=a+a,d=l+l,v=n*c,p=n*h,m=n*d,g=a*h,x=a*d,b=l*d,S=o*c,y=o*h,w=o*d,T=i[0],E=i[1],O=i[2];return r[0]=(1-(g+b))*T,r[1]=(p+w)*T,r[2]=(m-y)*T,r[3]=0,r[4]=(p-w)*E,r[5]=(1-(v+b))*E,r[6]=(x+S)*E,r[7]=0,r[8]=(m+y)*O,r[9]=(x-S)*O,r[10]=(1-(v+g))*O,r[11]=0,r[12]=s[0],r[13]=s[1],r[14]=s[2],r[15]=1,r}function Oi(t,e){let s=e[0],i=e[1],r=e[2],n=e[3],a=s+s,l=i+i,o=r+r,c=s*a,h=i*a,d=i*l,v=r*a,p=r*l,m=r*o,g=n*a,x=n*l,b=n*o;return t[0]=1-d-m,t[1]=h+b,t[2]=v-x,t[3]=0,t[4]=h-b,t[5]=1-c-m,t[6]=p+g,t[7]=0,t[8]=v+x,t[9]=p-g,t[10]=1-c-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Pi(t,e,s,i,r){let n=1/Math.tan(e/2),a=1/(i-r);return t[0]=n/s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*a,t[15]=0,t}function ki(t,e,s,i,r,n,a){let l=1/(e-s),o=1/(i-r),c=1/(n-a);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+s)*l,t[13]=(r+i)*o,t[14]=(a+n)*c,t[15]=1,t}function Ui(t,e,s,i){let r=e[0],n=e[1],a=e[2],l=i[0],o=i[1],c=i[2],h=r-s[0],d=n-s[1],v=a-s[2],p=h*h+d*d+v*v;p===0?v=1:(p=1/Math.sqrt(p),h*=p,d*=p,v*=p);let m=o*v-c*d,g=c*h-l*v,x=l*d-o*h;return p=m*m+g*g+x*x,p===0&&(c?l+=1e-6:o?c+=1e-6:o+=1e-6,m=o*v-c*d,g=c*h-l*v,x=l*d-o*h,p=m*m+g*g+x*x),p=1/Math.sqrt(p),m*=p,g*=p,x*=p,t[0]=m,t[1]=g,t[2]=x,t[3]=0,t[4]=d*x-v*g,t[5]=v*m-h*x,t[6]=h*g-d*m,t[7]=0,t[8]=h,t[9]=d,t[10]=v,t[11]=0,t[12]=r,t[13]=n,t[14]=a,t[15]=1,t}function Et(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t[3]=e[3]+s[3],t[4]=e[4]+s[4],t[5]=e[5]+s[5],t[6]=e[6]+s[6],t[7]=e[7]+s[7],t[8]=e[8]+s[8],t[9]=e[9]+s[9],t[10]=e[10]+s[10],t[11]=e[11]+s[11],t[12]=e[12]+s[12],t[13]=e[13]+s[13],t[14]=e[14]+s[14],t[15]=e[15]+s[15],t}function Mt(t,e,s){return t[0]=e[0]-s[0],t[1]=e[1]-s[1],t[2]=e[2]-s[2],t[3]=e[3]-s[3],t[4]=e[4]-s[4],t[5]=e[5]-s[5],t[6]=e[6]-s[6],t[7]=e[7]-s[7],t[8]=e[8]-s[8],t[9]=e[9]-s[9],t[10]=e[10]-s[10],t[11]=e[11]-s[11],t[12]=e[12]-s[12],t[13]=e[13]-s[13],t[14]=e[14]-s[14],t[15]=e[15]-s[15],t}function Gi(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12]*s,t[13]=e[13]*s,t[14]=e[14]*s,t[15]=e[15]*s,t}class Pe extends Array{constructor(e=1,s=0,i=0,r=0,n=0,a=1,l=0,o=0,c=0,h=0,d=1,v=0,p=0,m=0,g=0,x=1){return super(e,s,i,r,n,a,l,o,c,h,d,v,p,m,g,x),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(e){this[12]=e}set y(e){this[13]=e}set z(e){this[14]=e}set w(e){this[15]=e}set(e,s,i,r,n,a,l,o,c,h,d,v,p,m,g,x){return e.length?this.copy(e):(Ri(this,e,s,i,r,n,a,l,o,c,h,d,v,p,m,g,x),this)}translate(e,s=this){return Di(this,s,e),this}rotate(e,s,i=this){return Ni(this,i,e,s),this}scale(e,s=this){return zi(this,s,typeof e=="number"?[e,e,e]:e),this}add(e,s){return s?Et(this,e,s):Et(this,this,e),this}sub(e,s){return s?Mt(this,e,s):Mt(this,this,e),this}multiply(e,s){return e.length?s?_t(this,e,s):_t(this,this,e):Gi(this,this,e),this}identity(){return Ai(this),this}copy(e){return Ti(this,e),this}fromPerspective({fov:e,aspect:s,near:i,far:r}={}){return Pi(this,e,s,i,r),this}fromOrthogonal({left:e,right:s,bottom:i,top:r,near:n,far:a}){return ki(this,e,s,i,r,n,a),this}fromQuaternion(e){return Oi(this,e),this}setPosition(e){return this.x=e[0],this.y=e[1],this.z=e[2],this}inverse(e=this){return Ci(this,e),this}compose(e,s,i){return Li(this,e,s,i),this}decompose(e,s,i){return Bi(this,e,s,i),this}getRotation(e){return Xt(e,this),this}getTranslation(e){return Fi(e,this),this}getScaling(e){return qt(e,this),this}getMaxScaleOnAxis(){return Ii(this)}lookAt(e,s,i){return Ui(this,e,s,i),this}determinant(){return Wt(this)}fromArray(e,s=0){return this[0]=e[s],this[1]=e[s+1],this[2]=e[s+2],this[3]=e[s+3],this[4]=e[s+4],this[5]=e[s+5],this[6]=e[s+6],this[7]=e[s+7],this[8]=e[s+8],this[9]=e[s+9],this[10]=e[s+10],this[11]=e[s+11],this[12]=e[s+12],this[13]=e[s+13],this[14]=e[s+14],this[15]=e[s+15],this}toArray(e=[],s=0){return e[s]=this[0],e[s+1]=this[1],e[s+2]=this[2],e[s+3]=this[3],e[s+4]=this[4],e[s+5]=this[5],e[s+6]=this[6],e[s+7]=this[7],e[s+8]=this[8],e[s+9]=this[9],e[s+10]=this[10],e[s+11]=this[11],e[s+12]=this[12],e[s+13]=this[13],e[s+14]=this[14],e[s+15]=this[15],e}}function Hi(t,e,s="YXZ"){return s==="XYZ"?(t[1]=Math.asin(Math.min(Math.max(e[8],-1),1)),Math.abs(e[8])<.99999?(t[0]=Math.atan2(-e[9],e[10]),t[2]=Math.atan2(-e[4],e[0])):(t[0]=Math.atan2(e[6],e[5]),t[2]=0)):s==="YXZ"?(t[0]=Math.asin(-Math.min(Math.max(e[9],-1),1)),Math.abs(e[9])<.99999?(t[1]=Math.atan2(e[8],e[10]),t[2]=Math.atan2(e[1],e[5])):(t[1]=Math.atan2(-e[2],e[0]),t[2]=0)):s==="ZXY"?(t[0]=Math.asin(Math.min(Math.max(e[6],-1),1)),Math.abs(e[6])<.99999?(t[1]=Math.atan2(-e[2],e[10]),t[2]=Math.atan2(-e[4],e[5])):(t[1]=0,t[2]=Math.atan2(e[1],e[0]))):s==="ZYX"?(t[1]=Math.asin(-Math.min(Math.max(e[2],-1),1)),Math.abs(e[2])<.99999?(t[0]=Math.atan2(e[6],e[10]),t[2]=Math.atan2(e[1],e[0])):(t[0]=0,t[2]=Math.atan2(-e[4],e[5]))):s==="YZX"?(t[2]=Math.asin(Math.min(Math.max(e[1],-1),1)),Math.abs(e[1])<.99999?(t[0]=Math.atan2(-e[9],e[5]),t[1]=Math.atan2(-e[2],e[0])):(t[0]=0,t[1]=Math.atan2(e[8],e[10]))):s==="XZY"&&(t[2]=Math.asin(-Math.min(Math.max(e[4],-1),1)),Math.abs(e[4])<.99999?(t[0]=Math.atan2(e[6],e[5]),t[1]=Math.atan2(e[8],e[0])):(t[0]=Math.atan2(-e[9],e[10]),t[1]=0)),t}const Tt=new Pe;class ji extends Array{constructor(e=0,s=e,i=e,r="YXZ"){super(e,s,i),this.order=r,this.onChange=()=>{},this._target=this;const n=["0","1","2"];return new Proxy(this,{set(a,l){const o=Reflect.set(...arguments);return o&&n.includes(l)&&a.onChange(),o}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set(e,s=e,i=e){return e.length?this.copy(e):(this._target[0]=e,this._target[1]=s,this._target[2]=i,this.onChange(),this)}copy(e){return this._target[0]=e[0],this._target[1]=e[1],this._target[2]=e[2],this.onChange(),this}reorder(e){return this._target.order=e,this.onChange(),this}fromRotationMatrix(e,s=this.order){return Hi(this._target,e,s),this.onChange(),this}fromQuaternion(e,s=this.order,i){return Tt.fromQuaternion(e),this._target.fromRotationMatrix(Tt,s),i||this.onChange(),this}fromArray(e,s=0){return this._target[0]=e[s],this._target[1]=e[s+1],this._target[2]=e[s+2],this}toArray(e=[],s=0){return e[s]=this[0],e[s+1]=this[1],e[s+2]=this[2],e}}class Vi{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new Pe,this.worldMatrix=new Pe,this.matrixAutoUpdate=!0,this.worldMatrixNeedsUpdate=!1,this.position=new se,this.quaternion=new Ei,this.scale=new se(1),this.rotation=new ji,this.up=new se(0,1,0),this.rotation._target.onChange=()=>this.quaternion.fromEuler(this.rotation,!0),this.quaternion._target.onChange=()=>this.rotation.fromQuaternion(this.quaternion,void 0,!0)}setParent(e,s=!0){this.parent&&e!==this.parent&&this.parent.removeChild(this,!1),this.parent=e,s&&e&&e.addChild(this,!1)}addChild(e,s=!0){~this.children.indexOf(e)||this.children.push(e),s&&e.setParent(this,!1)}removeChild(e,s=!0){~this.children.indexOf(e)&&this.children.splice(this.children.indexOf(e),1),s&&e.setParent(null,!1)}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||e)&&(this.parent===null?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,e=!0);for(let s=0,i=this.children.length;s<i;s++)this.children[s].updateMatrixWorld(e)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(e){if(!e(this))for(let s=0,i=this.children.length;s<i;s++)this.children[s].traverse(e)}decompose(){this.matrix.decompose(this.quaternion._target,this.position,this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(e,s=!1){s?this.matrix.lookAt(this.position,e,this.up):this.matrix.lookAt(e,this.position,this.up),this.matrix.getRotation(this.quaternion._target),this.rotation.fromQuaternion(this.quaternion)}}function $i(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Wi(t,e){let s=e[0],i=e[1],r=e[2],n=e[3],a=s+s,l=i+i,o=r+r,c=s*a,h=i*a,d=i*l,v=r*a,p=r*l,m=r*o,g=n*a,x=n*l,b=n*o;return t[0]=1-d-m,t[3]=h-b,t[6]=v+x,t[1]=h+b,t[4]=1-c-m,t[7]=p-g,t[2]=v-x,t[5]=p+g,t[8]=1-c-d,t}function qi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Xi(t,e,s,i,r,n,a,l,o,c){return t[0]=e,t[1]=s,t[2]=i,t[3]=r,t[4]=n,t[5]=a,t[6]=l,t[7]=o,t[8]=c,t}function Yi(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Zi(t,e){let s=e[0],i=e[1],r=e[2],n=e[3],a=e[4],l=e[5],o=e[6],c=e[7],h=e[8],d=h*a-l*c,v=-h*n+l*o,p=c*n-a*o,m=s*d+i*v+r*p;return m?(m=1/m,t[0]=d*m,t[1]=(-h*i+r*c)*m,t[2]=(l*i-r*a)*m,t[3]=v*m,t[4]=(h*s-r*o)*m,t[5]=(-l*s+r*n)*m,t[6]=p*m,t[7]=(-c*s+i*o)*m,t[8]=(a*s-i*n)*m,t):null}function Rt(t,e,s){let i=e[0],r=e[1],n=e[2],a=e[3],l=e[4],o=e[5],c=e[6],h=e[7],d=e[8],v=s[0],p=s[1],m=s[2],g=s[3],x=s[4],b=s[5],S=s[6],y=s[7],w=s[8];return t[0]=v*i+p*a+m*c,t[1]=v*r+p*l+m*h,t[2]=v*n+p*o+m*d,t[3]=g*i+x*a+b*c,t[4]=g*r+x*l+b*h,t[5]=g*n+x*o+b*d,t[6]=S*i+y*a+w*c,t[7]=S*r+y*l+w*h,t[8]=S*n+y*o+w*d,t}function Ki(t,e,s){let i=e[0],r=e[1],n=e[2],a=e[3],l=e[4],o=e[5],c=e[6],h=e[7],d=e[8],v=s[0],p=s[1];return t[0]=i,t[1]=r,t[2]=n,t[3]=a,t[4]=l,t[5]=o,t[6]=v*i+p*a+c,t[7]=v*r+p*l+h,t[8]=v*n+p*o+d,t}function Qi(t,e,s){let i=e[0],r=e[1],n=e[2],a=e[3],l=e[4],o=e[5],c=e[6],h=e[7],d=e[8],v=Math.sin(s),p=Math.cos(s);return t[0]=p*i+v*a,t[1]=p*r+v*l,t[2]=p*n+v*o,t[3]=p*a-v*i,t[4]=p*l-v*r,t[5]=p*o-v*n,t[6]=c,t[7]=h,t[8]=d,t}function Ji(t,e,s){let i=s[0],r=s[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function er(t,e){let s=e[0],i=e[1],r=e[2],n=e[3],a=e[4],l=e[5],o=e[6],c=e[7],h=e[8],d=e[9],v=e[10],p=e[11],m=e[12],g=e[13],x=e[14],b=e[15],S=s*l-i*a,y=s*o-r*a,w=s*c-n*a,T=i*o-r*l,E=i*c-n*l,O=r*c-n*o,C=h*g-d*m,N=h*x-v*m,R=h*b-p*m,z=d*x-v*g,I=d*b-p*g,k=v*b-p*x,M=S*k-y*I+w*z+T*R-E*N+O*C;return M?(M=1/M,t[0]=(l*k-o*I+c*z)*M,t[1]=(o*R-a*k-c*N)*M,t[2]=(a*I-l*R+c*C)*M,t[3]=(r*I-i*k-n*z)*M,t[4]=(s*k-r*R+n*N)*M,t[5]=(i*R-s*I-n*C)*M,t[6]=(g*O-x*E+b*T)*M,t[7]=(x*w-m*O-b*y)*M,t[8]=(m*E-g*w+b*S)*M,t):null}class tr extends Array{constructor(e=1,s=0,i=0,r=0,n=1,a=0,l=0,o=0,c=1){return super(e,s,i,r,n,a,l,o,c),this}set(e,s,i,r,n,a,l,o,c){return e.length?this.copy(e):(Xi(this,e,s,i,r,n,a,l,o,c),this)}translate(e,s=this){return Ki(this,s,e),this}rotate(e,s=this){return Qi(this,s,e),this}scale(e,s=this){return Ji(this,s,e),this}multiply(e,s){return s?Rt(this,e,s):Rt(this,this,e),this}identity(){return Yi(this),this}copy(e){return qi(this,e),this}fromMatrix4(e){return $i(this,e),this}fromQuaternion(e){return Wi(this,e),this}fromBasis(e,s,i){return this.set(e[0],e[1],e[2],s[0],s[1],s[2],i[0],i[1],i[2]),this}inverse(e=this){return Zi(this,e),this}getNormalMatrix(e){return er(this,e),this}}let sr=0;class ir extends Vi{constructor(e,{geometry:s,program:i,mode:r=e.TRIANGLES,frustumCulled:n=!0,renderOrder:a=0}={}){super(),e.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=e,this.id=sr++,this.geometry=s,this.program=i,this.mode=r,this.frustumCulled=n,this.renderOrder=a,this.modelViewMatrix=new Pe,this.normalMatrix=new tr,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(e){return this.beforeRenderCallbacks.push(e),this}onAfterRender(e){return this.afterRenderCallbacks.push(e),this}draw({camera:e}={}){e&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=e.projectionMatrix,this.program.uniforms.cameraPosition.value=e.worldPosition,this.program.uniforms.viewMatrix.value=e.viewMatrix,this.modelViewMatrix.multiply(e.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix),this.beforeRenderCallbacks.forEach(i=>i&&i({mesh:this,camera:e}));let s=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:s}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(i=>i&&i({mesh:this,camera:e}))}}const At={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#00ff00",blue:"#0000ff",fuchsia:"#ff00ff",cyan:"#00ffff",yellow:"#ffff00",orange:"#ff8000"};function Ct(t){t.length===4&&(t=t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e||console.warn(`Unable to convert hex string ${t} to rgb values`),[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255]}function rr(t){return t=parseInt(t),[(t>>16&255)/255,(t>>8&255)/255,(t&255)/255]}function Dt(t){return t===void 0?[0,0,0]:arguments.length===3?arguments:isNaN(t)?t[0]==="#"?Ct(t):At[t.toLowerCase()]?Ct(At[t.toLowerCase()]):(console.warn("Color format not recognised"),[0,0,0]):rr(t)}class zt extends Array{constructor(e){return Array.isArray(e)?super(...e):super(...Dt(...arguments))}get r(){return this[0]}get g(){return this[1]}get b(){return this[2]}set r(e){this[0]=e}set g(e){this[1]=e}set b(e){this[2]=e}set(e){return Array.isArray(e)?this.copy(e):this.copy(Dt(...arguments))}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this}}class nr extends Qs{constructor(e,{attributes:s={}}={}){Object.assign(s,{position:{size:2,data:new Float32Array([-1,-1,3,-1,-1,3])},uv:{size:2,data:new Float32Array([0,0,2,0,0,2])}}),super(e,s)}}const ar=`
attribute vec2 uv;
attribute vec2 position;

varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = vec4(position, 0, 1);
}
`,or=`
precision highp float;

uniform float uTime;
uniform vec3 uResolution;
uniform vec2 uFocal;
uniform vec2 uRotation;
uniform float uStarSpeed;
uniform float uDensity;
uniform float uHueShift;
uniform float uSpeed;
uniform vec2 uMouse;
uniform float uGlowIntensity;
uniform float uSaturation;
uniform bool uMouseRepulsion;
uniform float uTwinkleIntensity;
uniform float uRotationSpeed;
uniform float uRepulsionStrength;
uniform float uMouseActiveFactor;
uniform float uAutoCenterRepulsion;
uniform bool uTransparent;

varying vec2 vUv;

#define NUM_LAYER 4.0
#define STAR_COLOR_CUTOFF 0.2
#define MAT45 mat2(0.7071, -0.7071, 0.7071, 0.7071)
#define PERIOD 3.0

float Hash21(vec2 p) {
  p = fract(p * vec2(123.34, 456.21));
  p += dot(p, p + 45.32);
  return fract(p.x * p.y);
}

float tri(float x) {
  return abs(fract(x) * 2.0 - 1.0);
}

float tris(float x) {
  float t = fract(x);
  return 1.0 - smoothstep(0.0, 1.0, abs(2.0 * t - 1.0));
}

float trisn(float x) {
  float t = fract(x);
  return 2.0 * (1.0 - smoothstep(0.0, 1.0, abs(2.0 * t - 1.0))) - 1.0;
}

vec3 hsv2rgb(vec3 c) {
  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}

float Star(vec2 uv, float flare) {
  float d = length(uv);
  float m = (0.05 * uGlowIntensity) / d;
  float rays = smoothstep(0.0, 1.0, 1.0 - abs(uv.x * uv.y * 1000.0));
  m += rays * flare * uGlowIntensity;
  uv *= MAT45;
  rays = smoothstep(0.0, 1.0, 1.0 - abs(uv.x * uv.y * 1000.0));
  m += rays * 0.3 * flare * uGlowIntensity;
  m *= smoothstep(1.0, 0.2, d);
  return m;
}

vec3 StarLayer(vec2 uv) {
  vec3 col = vec3(0.0);

  vec2 gv = fract(uv) - 0.5; 
  vec2 id = floor(uv);

  for (int y = -1; y <= 1; y++) {
    for (int x = -1; x <= 1; x++) {
      vec2 offset = vec2(float(x), float(y));
      vec2 si = id + vec2(float(x), float(y));
      float seed = Hash21(si);
      float size = fract(seed * 345.32);
      float glossLocal = tri(uStarSpeed / (PERIOD * seed + 1.0));
      float flareSize = smoothstep(0.9, 1.0, size) * glossLocal;

      float red = smoothstep(STAR_COLOR_CUTOFF, 1.0, Hash21(si + 1.0)) + STAR_COLOR_CUTOFF;
      float blu = smoothstep(STAR_COLOR_CUTOFF, 1.0, Hash21(si + 3.0)) + STAR_COLOR_CUTOFF;
      float grn = min(red, blu) * seed;
      vec3 base = vec3(red, grn, blu);
      
      float hue = atan(base.g - base.r, base.b - base.r) / (2.0 * 3.14159) + 0.5;
      hue = fract(hue + uHueShift / 360.0);
      float sat = length(base - vec3(dot(base, vec3(0.299, 0.587, 0.114)))) * uSaturation;
      float val = max(max(base.r, base.g), base.b);
      base = hsv2rgb(vec3(hue, sat, val));

      vec2 pad = vec2(tris(seed * 34.0 + uTime * uSpeed / 10.0), tris(seed * 38.0 + uTime * uSpeed / 30.0)) - 0.5;

      float star = Star(gv - offset - pad, flareSize);
      vec3 color = base;

      float twinkle = trisn(uTime * uSpeed + seed * 6.2831) * 0.5 + 1.0;
      twinkle = mix(1.0, twinkle, uTwinkleIntensity);
      star *= twinkle;
      
      col += star * size * color;
    }
  }

  return col;
}

void main() {
  vec2 focalPx = uFocal * uResolution.xy;
  vec2 uv = (vUv * uResolution.xy - focalPx) / uResolution.y;

  vec2 mouseNorm = uMouse - vec2(0.5);
  
  if (uAutoCenterRepulsion > 0.0) {
    vec2 centerUV = vec2(0.0, 0.0);
    float centerDist = length(uv - centerUV);
    vec2 repulsion = normalize(uv - centerUV) * (uAutoCenterRepulsion / (centerDist + 0.1));
    uv += repulsion * 0.05;
  } else if (uMouseRepulsion) {
    vec2 mousePosUV = (uMouse * uResolution.xy - focalPx) / uResolution.y;
    float mouseDist = length(uv - mousePosUV);
    vec2 repulsion = normalize(uv - mousePosUV) * (uRepulsionStrength / (mouseDist + 0.1));
    uv += repulsion * 0.05 * uMouseActiveFactor;
  } else {
    vec2 mouseOffset = mouseNorm * 0.1 * uMouseActiveFactor;
    uv += mouseOffset;
  }

  float autoRotAngle = uTime * uRotationSpeed;
  mat2 autoRot = mat2(cos(autoRotAngle), -sin(autoRotAngle), sin(autoRotAngle), cos(autoRotAngle));
  uv = autoRot * uv;

  uv = mat2(uRotation.x, -uRotation.y, uRotation.y, uRotation.x) * uv;

  vec3 col = vec3(0.0);

  for (float i = 0.0; i < 1.0; i += 1.0 / NUM_LAYER) {
    float depth = fract(i + uStarSpeed * uSpeed);
    float scale = mix(20.0 * uDensity, 0.5 * uDensity, depth);
    float fade = depth * smoothstep(1.0, 0.9, depth);
    col += StarLayer(uv * scale + i * 453.32) * fade;
  }

  if (uTransparent) {
    float alpha = length(col);
    alpha = smoothstep(0.0, 0.3, alpha);
    alpha = min(alpha, 1.0);
    gl_FragColor = vec4(col, alpha);
  } else {
    gl_FragColor = vec4(col, 1.0);
  }
}
`;function lr({focal:t=[.5,.5],rotation:e=[1,0],starSpeed:s=.5,density:i=1,hueShift:r=140,disableAnimation:n=!1,speed:a=1,mouseInteraction:l=!0,glowIntensity:o=.3,saturation:c=0,mouseRepulsion:h=!0,repulsionStrength:d=2,twinkleIntensity:v=.3,rotationSpeed:p=.1,autoCenterRepulsion:m=0,transparent:g=!0,...x}){const b=D.useRef(null),S=D.useRef({x:.5,y:.5}),y=D.useRef({x:.5,y:.5}),w=D.useRef(0),T=D.useRef(0);return D.useEffect(()=>{if(!b.current)return;const E=b.current,O=new ni({alpha:g,premultipliedAlpha:!1}),C=O.gl;g?(C.enable(C.BLEND),C.blendFunc(C.SRC_ALPHA,C.ONE_MINUS_SRC_ALPHA),C.clearColor(0,0,0,0)):C.clearColor(0,0,0,1);let N;function R(){O.setSize(E.offsetWidth*1,E.offsetHeight*1),N&&(N.uniforms.uResolution.value=new zt(C.canvas.width,C.canvas.height,C.canvas.width/C.canvas.height))}window.addEventListener("resize",R,!1),R();const z=new nr(C);N=new ei(C,{vertex:ar,fragment:or,uniforms:{uTime:{value:0},uResolution:{value:new zt(C.canvas.width,C.canvas.height,C.canvas.width/C.canvas.height)},uFocal:{value:new Float32Array(t)},uRotation:{value:new Float32Array(e)},uStarSpeed:{value:s},uDensity:{value:i},uHueShift:{value:r},uSpeed:{value:a},uMouse:{value:new Float32Array([y.current.x,y.current.y])},uGlowIntensity:{value:o},uSaturation:{value:c},uMouseRepulsion:{value:h},uTwinkleIntensity:{value:v},uRotationSpeed:{value:p},uRepulsionStrength:{value:d},uMouseActiveFactor:{value:0},uAutoCenterRepulsion:{value:m},uTransparent:{value:g}}});const I=new ir(C,{geometry:z,program:N});let k;function M(J){k=requestAnimationFrame(M),n||(N.uniforms.uTime.value=J*.001,N.uniforms.uStarSpeed.value=J*.001*s/10);const B=.05;y.current.x+=(S.current.x-y.current.x)*B,y.current.y+=(S.current.y-y.current.y)*B,T.current+=(w.current-T.current)*B,N.uniforms.uMouse.value[0]=y.current.x,N.uniforms.uMouse.value[1]=y.current.y,N.uniforms.uMouseActiveFactor.value=T.current,O.render({scene:I})}k=requestAnimationFrame(M),E.appendChild(C.canvas);function Y(J){const B=E.getBoundingClientRect(),F=(J.clientX-B.left)/B.width,L=1-(J.clientY-B.top)/B.height;S.current={x:F,y:L},w.current=1}function Z(){w.current=0}return l&&(E.addEventListener("mousemove",Y),E.addEventListener("mouseleave",Z)),()=>{var J;cancelAnimationFrame(k),window.removeEventListener("resize",R),l&&(E.removeEventListener("mousemove",Y),E.removeEventListener("mouseleave",Z)),E.removeChild(C.canvas),(J=C.getExtension("WEBGL_lose_context"))==null||J.loseContext()}},[t,e,s,i,r,n,a,l,o,c,h,v,p,d,m,g]),f.jsx("div",{ref:b,className:"galaxy-container",style:{touchAction:"pan-y",...x.style},...x})}/**
 * postprocessing v6.38.0 build Sat Nov 08 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var Ze=1/1e3,cr=1e3,hr=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(t){typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=t)}get delta(){return this._delta*Ze}get fixedDelta(){return this._fixedDelta*Ze}set fixedDelta(t){this._fixedDelta=t*cr}get elapsed(){return this._elapsed*Ze}update(t){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(t!==void 0?t:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(t){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},ur=(()=>{const t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),s=new Ht;return s.setAttribute("position",new Je(t,3)),s.setAttribute("uv",new Je(e,2)),s})(),ie=class st{static get fullscreenGeometry(){return ur}constructor(e="Pass",s=new Oe,i=new hs){this.name=e,this.renderer=null,this.scene=s,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const s=this.fullscreenMaterial;s!==null&&(s.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let s=this.screen;s!==null?s.material=e:(s=new Fe(st.fullscreenGeometry,e),s.frustumCulled=!1,this.scene===null&&(this.scene=new Oe),this.scene.add(s),this.screen=s)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,s=be){}render(e,s,i,r,n){throw new Error("Render method not implemented!")}setSize(e,s){}initialize(e,s,i){}dispose(){for(const e of Object.keys(this)){const s=this[e];(s instanceof ve||s instanceof Ut||s instanceof Gt||s instanceof st)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},dr=class extends ie{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,s,i,r){const n=t.state.buffers.stencil;n.setLocked(!1),n.setTest(!1)}},fr=`#ifdef COLOR_WRITE
#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#endif
#ifdef DEPTH_WRITE
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}
#endif
#ifdef USE_WEIGHTS
uniform vec4 channelWeights;
#endif
uniform float opacity;varying vec2 vUv;void main(){
#ifdef COLOR_WRITE
vec4 texel=texture2D(inputBuffer,vUv);
#ifdef USE_WEIGHTS
texel*=channelWeights;
#endif
gl_FragColor=opacity*texel;
#ifdef COLOR_SPACE_CONVERSION
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
#else
gl_FragColor=vec4(0.0);
#endif
#ifdef DEPTH_WRITE
gl_FragDepth=readDepth(vUv);
#endif
}`,pr="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",vr=class extends ke{constructor(){super({name:"CopyMaterial",defines:{DEPTH_PACKING:"0",COLOR_WRITE:"1"},uniforms:{inputBuffer:new $(null),depthBuffer:new $(null),channelWeights:new $(null),opacity:new $(1)},blending:nt,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:fr,vertexShader:pr}),this.depthFunc=ps}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(t){const e=t!==null;this.colorWrite!==e&&(e?this.defines.COLOR_WRITE=!0:delete this.defines.COLOR_WRITE,this.colorWrite=e,this.needsUpdate=!0),this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){const e=t!==null;this.depthWrite!==e&&(e?this.defines.DEPTH_WRITE=!0:delete this.defines.DEPTH_WRITE,this.depthTest=e,this.depthWrite=e,this.needsUpdate=!0),this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}get channelWeights(){return this.uniforms.channelWeights.value}set channelWeights(t){t!==null?(this.defines.USE_WEIGHTS="1",this.uniforms.channelWeights.value=t):delete this.defines.USE_WEIGHTS,this.needsUpdate=!0}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},mr=class extends ie{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new vr,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new ve(1,1,{minFilter:de,magFilter:de,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,s,i,r){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,s){s!==void 0&&(this.renderTarget.texture.type=s,s!==Be?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t!==null&&t.outputColorSpace===ce&&(this.renderTarget.texture.colorSpace=ce))}},Nt=new Te,Yt=class extends ie{constructor(t=!0,e=!0,s=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=s,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,s){this.color=t,this.depth=e,this.stencil=s}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,s,i,r){const n=this.overrideClearColor,a=this.overrideClearAlpha,l=t.getClearAlpha(),o=n!==null,c=a>=0;o?(t.getClearColor(Nt),t.setClearColor(n,c?a:l)):c&&t.setClearAlpha(a),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),o?t.setClearColor(Nt,l):c&&t.setClearAlpha(l)}},gr=class extends ie{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new Yt(!1,!1,!0),this.inverse=!1}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,s,i,r){const n=t.getContext(),a=t.state.buffers,l=this.scene,o=this.camera,c=this.clearPass,h=this.inverted?0:1,d=1-h;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(n.REPLACE,n.REPLACE,n.REPLACE),a.stencil.setFunc(n.ALWAYS,h,4294967295),a.stencil.setClear(d),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(t,null):(c.render(t,e),c.render(t,s))),this.renderToScreen?(t.setRenderTarget(null),t.render(l,o)):(t.setRenderTarget(e),t.render(l,o),t.setRenderTarget(s),t.render(l,o)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(n.EQUAL,1,4294967295),a.stencil.setOp(n.KEEP,n.KEEP,n.KEEP),a.stencil.setLocked(!0)}},xr=class{constructor(e=null,{depthBuffer:s=!0,stencilBuffer:i=!1,multisampling:r=0,frameBufferType:n}={}){this.renderer=null,this.inputBuffer=this.createBuffer(s,i,n,r),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new mr,this.depthTexture=null,this.passes=[],this.timer=new hr,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const s=this.inputBuffer,i=this.multisampling;i>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):i!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(s.depthBuffer,s.stencilBuffer,s.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const s=e.getSize(new G),i=e.getContext().getContextAttributes().alpha,r=this.inputBuffer.texture.type;r===Be&&e.outputColorSpace===ce&&(this.inputBuffer.texture.colorSpace=ce,this.outputBuffer.texture.colorSpace=ce,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(s.width,s.height);for(const n of this.passes)n.initialize(e,i,r)}}replaceRenderer(e,s=!0){const i=this.renderer,r=i.domElement.parentNode;return this.setRenderer(e),s&&r!==null&&(r.removeChild(i.domElement),r.appendChild(e.domElement)),i}createDepthTexture(){const e=this.depthTexture=new ns;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=as,e.type=os):e.type=ls,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,s,i,r){const n=this.renderer,a=n===null?new G:n.getDrawingBufferSize(new G),l={minFilter:de,magFilter:de,stencilBuffer:s,depthBuffer:e,type:i},o=new ve(a.width,a.height,l);return r>0&&(o.samples=r),i===Be&&n!==null&&n.outputColorSpace===ce&&(o.texture.colorSpace=ce),o.texture.name="EffectComposer.Buffer",o.texture.generateMipmaps=!1,o}setMainScene(e){for(const s of this.passes)s.mainScene=e}setMainCamera(e){for(const s of this.passes)s.mainCamera=e}addPass(e,s){const i=this.passes,r=this.renderer,n=r.getDrawingBufferSize(new G),a=r.getContext().getContextAttributes().alpha,l=this.inputBuffer.texture.type;if(e.setRenderer(r),e.setSize(n.width,n.height),e.initialize(r,a,l),this.autoRenderToScreen&&(i.length>0&&(i[i.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),s!==void 0?i.splice(s,0,e):i.push(e),this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const o=this.createDepthTexture();for(e of i)e.setDepthTexture(o)}else e.setDepthTexture(this.depthTexture)}removePass(e){const s=this.passes,i=s.indexOf(e);if(i!==-1&&s.splice(i,1).length>0){if(this.depthTexture!==null){const a=(o,c)=>o||c.needsDepthTexture;s.reduce(a,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&i===s.length&&(e.renderToScreen=!1,s.length>0&&(s[s.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const s=this.renderer,i=this.copyPass;let r=this.inputBuffer,n=this.outputBuffer,a=!1,l,o,c;e===void 0&&(this.timer.update(),e=this.timer.getDelta());for(const h of this.passes)h.enabled&&(h.render(s,r,n,e,a),h.needsSwap&&(a&&(i.renderToScreen=h.renderToScreen,l=s.getContext(),o=s.state.buffers.stencil,o.setFunc(l.NOTEQUAL,1,4294967295),i.render(s,r,n,e,a),o.setFunc(l.EQUAL,1,4294967295)),c=r,r=n,n=c),h instanceof gr?a=!0:h instanceof dr&&(a=!1))}setSize(e,s,i){const r=this.renderer,n=r.getSize(new G);(e===void 0||s===void 0)&&(e=n.width,s=n.height),(n.width!==e||n.height!==s)&&r.setSize(e,s,i);const a=r.getDrawingBufferSize(new G);this.inputBuffer.setSize(a.width,a.height),this.outputBuffer.setSize(a.width,a.height);for(const l of this.passes)l.setSize(a.width,a.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),ie.fullscreenGeometry.dispose()}},he={NONE:0,DEPTH:1,CONVOLUTION:2},U={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},yr=class{constructor(){this.shaderParts=new Map([[U.FRAGMENT_HEAD,null],[U.FRAGMENT_MAIN_UV,null],[U.FRAGMENT_MAIN_IMAGE,null],[U.VERTEX_HEAD,null],[U.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=he.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Pt}},Ke=!1,Ft=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let s;if(e.material.flatShading)switch(e.material.side){case De:s=this.materialsFlatShadedDoubleSide;break;case Ce:s=this.materialsFlatShadedBackSide;break;default:s=this.materialsFlatShaded;break}else switch(e.material.side){case De:s=this.materialsDoubleSide;break;case Ce:s=this.materialsBackSide;break;default:s=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=s[2]:e.isInstancedMesh?e.material=s[1]:e.material=s[0],++this.meshCount}}}cloneMaterial(t){if(!(t instanceof ke))return t.clone();const e=t.uniforms,s=new Map;for(const r in e){const n=e[r].value;n.isRenderTargetTexture&&(e[r].value=null,s.set(r,n))}const i=t.clone();for(const r of s)e[r[0]].value=r[1],i.uniforms[r[0]].value=r[1];return i}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){const e=this.materials=[this.cloneMaterial(t),this.cloneMaterial(t),this.cloneMaterial(t)];for(const s of e)s.uniforms=Object.assign({},t.uniforms),s.side=us;e[2].skinning=!0,this.materialsBackSide=e.map(s=>{const i=this.cloneMaterial(s);return i.uniforms=Object.assign({},t.uniforms),i.side=Ce,i}),this.materialsDoubleSide=e.map(s=>{const i=this.cloneMaterial(s);return i.uniforms=Object.assign({},t.uniforms),i.side=De,i}),this.materialsFlatShaded=e.map(s=>{const i=this.cloneMaterial(s);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=e.map(s=>{const i=this.cloneMaterial(s);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=Ce,i}),this.materialsFlatShadedDoubleSide=e.map(s=>{const i=this.cloneMaterial(s);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=De,i})}}render(t,e,s){const i=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,Ke){const r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,s);for(const n of r)n[0].material=n[1];this.meshCount!==r.size&&r.clear()}else{const r=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,s),e.overrideMaterial=r}t.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){const t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Ke}static set workaroundEnabled(t){Ke=t}},ue=-1,ye=class extends rt{constructor(t,e=ue,s=ue,i=1){super(),this.resizable=t,this.baseSize=new G(1,1),this.preferredSize=new G(e,s),this.target=this.preferredSize,this.s=i,this.effectiveSize=new G,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const t=this.baseSize,e=this.preferredSize,s=this.effectiveSize,i=this.scale;e.width!==ue?s.width=e.width:e.height!==ue?s.width=Math.round(e.height*(t.width/Math.max(t.height,1))):s.width=Math.round(t.width*i),e.height!==ue?s.height=e.height:e.width!==ue?s.height=Math.round(e.width/Math.max(t.width/Math.max(t.height,1),1)):s.height=Math.round(t.height*i)}get width(){return this.effectiveSize.width}set width(t){this.preferredWidth=t}get height(){return this.effectiveSize.height}set height(t){this.preferredHeight=t}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(t){this.s!==t&&(this.s=t,this.preferredSize.setScalar(ue),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(t){this.scale=t}get baseWidth(){return this.baseSize.width}set baseWidth(t){this.baseSize.width!==t&&(this.baseSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(t){this.baseWidth=t}get baseHeight(){return this.baseSize.height}set baseHeight(t){this.baseSize.height!==t&&(this.baseSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(t){this.baseHeight=t}setBaseSize(t,e){(this.baseSize.width!==t||this.baseSize.height!==e)&&(this.baseSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(t){this.preferredSize.width!==t&&(this.preferredSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(t){this.preferredWidth=t}get preferredHeight(){return this.preferredSize.height}set preferredHeight(t){this.preferredSize.height!==t&&(this.preferredSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(t){this.preferredHeight=t}setPreferredSize(t,e){(this.preferredSize.width!==t||this.preferredSize.height!==e)&&(this.preferredSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(t){this.s=t.scale,this.baseSize.set(t.baseWidth,t.baseHeight),this.preferredSize.set(t.preferredWidth,t.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return ue}},P={ADD:0,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},br="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),y.a*opacity);}",wr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),y.a*opacity);}",Sr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",_r="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),y.a*opacity);}",Er="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),y.a*opacity);}",Mr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),y.a*opacity);}",Tr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),y.a*opacity);}",Rr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),y.a*opacity);}",Ar="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),y.a*opacity);}",Cr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),y.a*opacity);}",Dr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),y.a*opacity);}",zr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),y.a*opacity);}",Nr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),y.a*opacity);}",Fr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),y.a*opacity);}",Ir="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),y.a*opacity);}",Br="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",Lr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),y.a*opacity);}",Or="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",Pr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",kr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),y.a*opacity);}",Ur="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),y.a*opacity);}",Gr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",Hr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",jr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),y.a*opacity);}",Vr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",$r="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",Wr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),y.a*opacity);}",qr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),y.a*opacity);}",Xr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",Yr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),y.a*opacity);}",Zr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",Kr=new Map([[P.ADD,br],[P.AVERAGE,wr],[P.COLOR,Sr],[P.COLOR_BURN,_r],[P.COLOR_DODGE,Er],[P.DARKEN,Mr],[P.DIFFERENCE,Tr],[P.DIVIDE,Rr],[P.DST,null],[P.EXCLUSION,Ar],[P.HARD_LIGHT,Cr],[P.HARD_MIX,Dr],[P.HUE,zr],[P.INVERT,Nr],[P.INVERT_RGB,Fr],[P.LIGHTEN,Ir],[P.LINEAR_BURN,Br],[P.LINEAR_DODGE,Lr],[P.LINEAR_LIGHT,Or],[P.LUMINOSITY,Pr],[P.MULTIPLY,kr],[P.NEGATION,Ur],[P.NORMAL,Gr],[P.OVERLAY,Hr],[P.PIN_LIGHT,jr],[P.REFLECT,Vr],[P.SATURATION,$r],[P.SCREEN,Wr],[P.SOFT_LIGHT,qr],[P.SRC,Xr],[P.SUBTRACT,Yr],[P.VIVID_LIGHT,Zr]]),Qr=class extends rt{constructor(t,e=1){super(),this._blendFunction=t,this.opacity=new $(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this._blendFunction}set blendFunction(t){this._blendFunction=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return Kr.get(this.blendFunction)}},it=class extends rt{constructor(t,e,{attributes:s=he.NONE,blendFunction:i=P.NORMAL,defines:r=new Map,uniforms:n=new Map,extensions:a=null,vertexShader:l=null}={}){super(),this.name=t,this.renderer=null,this.attributes=s,this.fragmentShader=e,this.vertexShader=l,this.defines=r,this.uniforms=n,this.extensions=a,this.blendMode=new Qr(i),this.blendMode.addEventListener("change",o=>this.setChanged()),this._inputColorSpace=Pt,this._outputColorSpace=kt}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(t){this._inputColorSpace=t,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t,this.setChanged()}set mainScene(t){}set mainCamera(t){}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=be){}update(t,e,s){}setSize(t,e){}initialize(t,e,s){}dispose(){for(const t of Object.keys(this)){const e=this[t];(e instanceof ve||e instanceof Ut||e instanceof Gt||e instanceof ie)&&this[t].dispose()}}},Zt=class extends ie{constructor(t,e,s=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new Yt,this.overrideMaterialManager=s===null?null:new Ft(s),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){const t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){const e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new Ft(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,s,i,r){const n=this.scene,a=this.camera,l=this.selection,o=a.layers.mask,c=n.background,h=t.shadowMap.autoUpdate,d=this.renderToScreen?null:e;l!==null&&a.layers.set(l.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(n.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(d),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,n,a):t.render(n,a),a.layers.mask=o,n.background=c,t.shadowMap.autoUpdate=h}},Jr=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,en="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",tn=class extends ke{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new $(null),normalBuffer:new $(null),texelSize:new $(new G)},blending:nt,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Jr,vertexShader:en})}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=be){this.depthBuffer=t,this.depthPacking=e}set normalBuffer(t){this.uniforms.normalBuffer.value=t,t!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(t){this.normalBuffer=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e)}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},sn=class extends ie{constructor({normalBuffer:t=null,resolutionScale:e=.5,width:s=ye.AUTO_SIZE,height:i=ye.AUTO_SIZE,resolutionX:r=s,resolutionY:n=i}={}){super("DepthDownsamplingPass");const a=new tn;a.normalBuffer=t,this.fullscreenMaterial=a,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new ve(1,1,{minFilter:Le,magFilter:Le,depthBuffer:!1,type:Ot}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const l=this.resolution=new ye(this,r,n,e);l.addEventListener("change",o=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(t,e=be){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e}render(t,e,s,i,r){t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){const s=this.resolution;s.setBaseSize(t,e),this.renderTarget.setSize(s.width,s.height),this.fullscreenMaterial.setSize(t,e)}initialize(t,e,s){const i=t.getContext();if(!(i.getExtension("EXT_color_buffer_float")||i.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},rn=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,nn="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",an=class extends ke{constructor(t,e,s,i,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:ds.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new $(null),depthBuffer:new $(null),resolution:new $(new G),texelSize:new $(new G),cameraNear:new $(.3),cameraFar:new $(1e3),aspect:new $(1),time:new $(0)},blending:nt,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:r}),t&&this.setShaderParts(t),e&&this.setDefines(e),s&&this.setUniforms(s),this.copyCameraSettings(i)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=be){this.depthBuffer=t,this.depthPacking=e}setShaderData(t){this.setShaderParts(t.shaderParts),this.setDefines(t.defines),this.setUniforms(t.uniforms),this.setExtensions(t.extensions)}setShaderParts(t){return this.fragmentShader=rn.replace(U.FRAGMENT_HEAD,t.get(U.FRAGMENT_HEAD)||"").replace(U.FRAGMENT_MAIN_UV,t.get(U.FRAGMENT_MAIN_UV)||"").replace(U.FRAGMENT_MAIN_IMAGE,t.get(U.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=nn.replace(U.VERTEX_HEAD,t.get(U.VERTEX_HEAD)||"").replace(U.VERTEX_MAIN_SUPPORT,t.get(U.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(t){for(const e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(const e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(const e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){this.copyCameraSettings(t)}copyCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof fs?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){const s=this.uniforms;s.resolution.value.set(t,e),s.texelSize.value.set(1/t,1/e),s.aspect.value=t/e}static get Section(){return U}};function It(t,e,s){for(const i of e){const r="$1"+t+i.charAt(0).toUpperCase()+i.slice(1),n=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(const a of s.entries())a[1]!==null&&s.set(a[0],a[1].replace(n,r))}}function on(t,e,s){let i=e.getFragmentShader(),r=e.getVertexShader();const n=i!==void 0&&/mainImage/.test(i),a=i!==void 0&&/mainUv/.test(i);if(s.attributes|=e.getAttributes(),i===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&s.attributes&he.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!n&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const l=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,o=s.shaderParts;let c=o.get(U.FRAGMENT_HEAD)||"",h=o.get(U.FRAGMENT_MAIN_UV)||"",d=o.get(U.FRAGMENT_MAIN_IMAGE)||"",v=o.get(U.VERTEX_HEAD)||"",p=o.get(U.VERTEX_MAIN_SUPPORT)||"";const m=new Set,g=new Set;if(a&&(h+=`	${t}MainUv(UV);
`,s.uvTransformation=!0),r!==null&&/mainSupport/.test(r)){const S=/mainSupport *\([\w\s]*?uv\s*?\)/.test(r);p+=`	${t}MainSupport(`,p+=S?`vUv);
`:`);
`;for(const y of r.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const w of y[1].split(/\s*,\s*/))s.varyings.add(w),m.add(w),g.add(w);for(const y of r.matchAll(l))g.add(y[1])}for(const S of i.matchAll(l))g.add(S[1]);for(const S of e.defines.keys())g.add(S.replace(/\([\w\s,]*\)/g,""));for(const S of e.uniforms.keys())g.add(S);g.delete("while"),g.delete("for"),g.delete("if"),e.uniforms.forEach((S,y)=>s.uniforms.set(t+y.charAt(0).toUpperCase()+y.slice(1),S)),e.defines.forEach((S,y)=>s.defines.set(t+y.charAt(0).toUpperCase()+y.slice(1),S));const x=new Map([["fragment",i],["vertex",r]]);It(t,g,s.defines),It(t,g,x),i=x.get("fragment"),r=x.get("vertex");const b=e.blendMode;if(s.blendModes.set(b.blendFunction,b),n){e.inputColorSpace!==null&&e.inputColorSpace!==s.colorSpace&&(d+=e.inputColorSpace===ce?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==kt?s.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(s.colorSpace=e.inputColorSpace);const S=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;d+=`${t}MainImage(color0, UV, `,s.attributes&he.DEPTH&&S.test(i)&&(d+="depth, ",s.readDepth=!0),d+=`color1);
	`;const y=t+"BlendOpacity";s.uniforms.set(y,b.opacity),d+=`color0 = blend${b.blendFunction}(color0, color1, ${y});

	`,c+=`uniform float ${y};

`}if(c+=i+`
`,r!==null&&(v+=r+`
`),o.set(U.FRAGMENT_HEAD,c),o.set(U.FRAGMENT_MAIN_UV,h),o.set(U.FRAGMENT_MAIN_IMAGE,d),o.set(U.VERTEX_HEAD,v),o.set(U.VERTEX_MAIN_SUPPORT,p),e.extensions!==null)for(const S of e.extensions)s.extensions.add(S)}}var ln=class extends ie{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new an(null,null,null,t),this.listener=s=>this.handleEvent(s),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(t){for(const e of this.effects)e.mainScene=t}set mainCamera(t){this.fullscreenMaterial.copyCameraSettings(t);for(const e of this.effects)e.mainCamera=t}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){const e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}setEffects(t){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=t.sort((e,s)=>s.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const t=new yr;let e=0;for(const a of this.effects)if(a.blendMode.blendFunction===P.DST)t.attributes|=a.getAttributes()&he.DEPTH;else{if(t.attributes&a.getAttributes()&he.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${a.name})`);on("e"+e++,a,t)}let s=t.shaderParts.get(U.FRAGMENT_HEAD),i=t.shaderParts.get(U.FRAGMENT_MAIN_IMAGE),r=t.shaderParts.get(U.FRAGMENT_MAIN_UV);const n=/\bblend\b/g;for(const a of t.blendModes.values())s+=a.getShaderCode().replace(n,`blend${a.blendFunction}`)+`
`;t.attributes&he.DEPTH?(t.readDepth&&(i=`float depth = readDepth(UV);

	`+i),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,t.colorSpace===ce&&(i+=`color0 = sRGBToLinear(color0);
	`),t.uvTransformation?(r=`vec2 transformedUv = vUv;
`+r,t.defines.set("UV","transformedUv")):t.defines.set("UV","vUv"),t.shaderParts.set(U.FRAGMENT_HEAD,s),t.shaderParts.set(U.FRAGMENT_MAIN_IMAGE,i),t.shaderParts.set(U.FRAGMENT_MAIN_UV,r);for(const[a,l]of t.shaderParts)l!==null&&t.shaderParts.set(a,l.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(t)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=be){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(const s of this.effects)s.setDepthTexture(t,e)}render(t,e,s,i,r){for(const n of this.effects)n.update(t,e,i);if(!this.skipRendering||this.renderToScreen){const n=this.fullscreenMaterial;n.inputBuffer=e.texture,n.time+=i*this.timeScale,t.setRenderTarget(this.renderToScreen?null:s),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(const s of this.effects)s.setSize(t,e)}initialize(t,e,s){this.renderer=t;for(const i of this.effects)i.initialize(t,e,s);this.updateMaterial(),s!==void 0&&s!==Be&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const t of this.effects)t.removeEventListener("change",this.listener),t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}},cn=class extends ie{constructor(t,e,{renderTarget:s,resolutionScale:i=1,width:r=ye.AUTO_SIZE,height:n=ye.AUTO_SIZE,resolutionX:a=r,resolutionY:l=n}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new Zt(t,e,new cs);const o=this.renderPass;o.ignoreBackground=!0,o.skipShadowMapUpdate=!0;const c=o.getClearPass();c.overrideClearColor=new Te(7829503),c.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new ve(1,1,{minFilter:Le,magFilter:Le}),this.renderTarget.texture.name="NormalPass.Target");const h=this.resolution=new ye(this,a,l,i);h.addEventListener("change",d=>this.setSize(h.baseWidth,h.baseHeight))}set mainScene(t){this.renderPass.mainScene=t}set mainCamera(t){this.renderPass.mainCamera=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,s,i,r){const n=this.renderToScreen?null:this.renderTarget;this.renderPass.render(t,n,n)}setSize(t,e){const s=this.resolution;s.setBaseSize(t,e),this.renderTarget.setSize(s.width,s.height)}};let _e;function hn(){var t;if(_e!==void 0)return _e;try{let e;const s=document.createElement("canvas");return _e=!!(window.WebGL2RenderingContext&&(e=s.getContext("webgl2"))),e&&((t=e.getExtension("WEBGL_lose_context"))==null||t.loseContext()),_e}catch{return _e=!1}}const un=D.createContext(null),Bt=t=>(t.getAttributes()&he.CONVOLUTION)===he.CONVOLUTION,dn=fe.memo(D.forwardRef(({children:t,camera:e,scene:s,resolutionScale:i,enabled:r=!0,renderPriority:n=1,autoClear:a=!0,depthBuffer:l,disableNormalPass:o,stencilBuffer:c,multisampling:h=8,frameBufferType:d=jt},v)=>{const{gl:p,scene:m,camera:g,size:x}=at(),b=s||m,S=e||g,[y,w,T]=D.useMemo(()=>{const N=hn(),R=new xr(p,{depthBuffer:l,stencilBuffer:c,multisampling:h>0&&N?h:0,frameBufferType:d});R.addPass(new Zt(b,S));let z=null,I=null;return o||(I=new cn(b,S),I.enabled=!1,R.addPass(I),i!==void 0&&N&&(z=new sn({normalBuffer:I.texture,resolutionScale:i}),z.enabled=!1,R.addPass(z))),[R,I,z]},[S,p,l,c,h,d,b,o,i]);D.useEffect(()=>y==null?void 0:y.setSize(x.width,x.height),[y,x]),Vt((N,R)=>{if(r){const z=p.autoClear;p.autoClear=a,c&&!a&&p.clearStencil(),y.render(R),p.autoClear=z}},r?n:0);const E=D.useRef(null),O=vs(E);D.useLayoutEffect(()=>{const N=[];if(E.current&&O.current&&y){const R=O.current.objects;for(let z=0;z<R.length;z++){const I=R[z];if(I instanceof it){const k=[I];if(!Bt(I)){let Y=null;for(;(Y=R[z+1])instanceof it&&!Bt(Y);)k.push(Y),z++}const M=new ln(S,...k);N.push(M)}else I instanceof ie&&N.push(I)}for(const z of N)y==null||y.addPass(z);w&&(w.enabled=!0),T&&(T.enabled=!0)}return()=>{for(const R of N)y==null||y.removePass(R);w&&(w.enabled=!1),T&&(T.enabled=!1)}},[y,t,S,w,T,O]);const C=D.useMemo(()=>({composer:y,normalPass:w,downSamplingPass:T,resolutionScale:i,camera:S,scene:b}),[y,w,T,i,S,b]);return D.useImperativeHandle(v,()=>y,[y]),f.jsx(un.Provider,{value:C,children:f.jsx("group",{ref:E,children:t})})}));let fn=0;const Lt=new WeakMap,pn=(t,e)=>fe.forwardRef(function({blendFunction:i=void 0,opacity:r=void 0,...n},a){let l=Lt.get(t);if(!l){const h=`@react-three/postprocessing/${t.name}-${fn++}`;ms({[h]:t}),Lt.set(t,l=h)}const o=at(h=>h.camera),c=fe.useMemo(()=>{var h,d;return[...(h=void 0)!=null?h:[],...(d=n.args)!=null?d:[{...e,...n}]]},[JSON.stringify(n)]);return f.jsx(l,{camera:o,"blendMode-blendFunction":i,"blendMode-opacity-value":r,...n,ref:a,args:c})}),vn=`
precision highp float;
varying vec2 vUv;
void main() {
  vUv = uv;
  vec4 modelPosition = modelMatrix * vec4(position, 1.0);
  vec4 viewPosition = viewMatrix * modelPosition;
  gl_Position = projectionMatrix * viewPosition;
}
`,mn=`
precision highp float;
uniform vec2 resolution;
uniform float time;
uniform float waveSpeed;
uniform float waveFrequency;
uniform float waveAmplitude;
uniform vec3 waveColor;
uniform vec2 mousePos;
uniform int enableMouseInteraction;
uniform float mouseRadius;

vec4 mod289(vec4 x) { return x - floor(x * (1.0/289.0)) * 289.0; }
vec4 permute(vec4 x) { return mod289(((x * 34.0) + 1.0) * x); }
vec4 taylorInvSqrt(vec4 r) { return 1.79284291400159 - 0.85373472095314 * r; }
vec2 fade(vec2 t) { return t*t*t*(t*(t*6.0-15.0)+10.0); }

float cnoise(vec2 P) {
  vec4 Pi = floor(P.xyxy) + vec4(0.0,0.0,1.0,1.0);
  vec4 Pf = fract(P.xyxy) - vec4(0.0,0.0,1.0,1.0);
  Pi = mod289(Pi);
  vec4 ix = Pi.xzxz;
  vec4 iy = Pi.yyww;
  vec4 fx = Pf.xzxz;
  vec4 fy = Pf.yyww;
  vec4 i = permute(permute(ix) + iy);
  vec4 gx = fract(i * (1.0/41.0)) * 2.0 - 1.0;
  vec4 gy = abs(gx) - 0.5;
  vec4 tx = floor(gx + 0.5);
  gx = gx - tx;
  vec2 g00 = vec2(gx.x, gy.x);
  vec2 g10 = vec2(gx.y, gy.y);
  vec2 g01 = vec2(gx.z, gy.z);
  vec2 g11 = vec2(gx.w, gy.w);
  vec4 norm = taylorInvSqrt(vec4(dot(g00,g00), dot(g01,g01), dot(g10,g10), dot(g11,g11)));
  g00 *= norm.x; g01 *= norm.y; g10 *= norm.z; g11 *= norm.w;
  float n00 = dot(g00, vec2(fx.x, fy.x));
  float n10 = dot(g10, vec2(fx.y, fy.y));
  float n01 = dot(g01, vec2(fx.z, fy.z));
  float n11 = dot(g11, vec2(fx.w, fy.w));
  vec2 fade_xy = fade(Pf.xy);
  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);
  return 2.3 * mix(n_x.x, n_x.y, fade_xy.y);
}

const int OCTAVES = 4;
float fbm(vec2 p) {
  float value = 0.0;
  float amp = 1.0;
  float freq = waveFrequency;
  for (int i = 0; i < OCTAVES; i++) {
    value += amp * abs(cnoise(p));
    p *= freq;
    amp *= waveAmplitude;
  }
  return value;
}

float pattern(vec2 p) {
  vec2 p2 = p - time * waveSpeed;
  return fbm(p + fbm(p2)); 
}

void main() {
  vec2 uv = gl_FragCoord.xy / resolution.xy;
  uv -= 0.5;
  uv.x *= resolution.x / resolution.y;
  float f = pattern(uv);
  if (enableMouseInteraction == 1) {
    vec2 mouseNDC = (mousePos / resolution - 0.5) * vec2(1.0, -1.0);
    mouseNDC.x *= resolution.x / resolution.y;
    float dist = length(uv - mouseNDC);
    float effect = 1.0 - smoothstep(0.0, mouseRadius, dist);
    f -= 0.5 * effect;
  }
  vec3 col = mix(vec3(0.0), waveColor, f);
  gl_FragColor = vec4(col, 1.0);
}
`,gn=`
precision highp float;
uniform float colorNum;
uniform float pixelSize;
const float bayerMatrix8x8[64] = float[64](
  0.0/64.0, 48.0/64.0, 12.0/64.0, 60.0/64.0,  3.0/64.0, 51.0/64.0, 15.0/64.0, 63.0/64.0,
  32.0/64.0,16.0/64.0, 44.0/64.0, 28.0/64.0, 35.0/64.0,19.0/64.0, 47.0/64.0, 31.0/64.0,
  8.0/64.0, 56.0/64.0,  4.0/64.0, 52.0/64.0, 11.0/64.0,59.0/64.0,  7.0/64.0, 55.0/64.0,
  40.0/64.0,24.0/64.0, 36.0/64.0, 20.0/64.0, 43.0/64.0,27.0/64.0, 39.0/64.0, 23.0/64.0,
  2.0/64.0, 50.0/64.0, 14.0/64.0, 62.0/64.0,  1.0/64.0,49.0/64.0, 13.0/64.0, 61.0/64.0,
  34.0/64.0,18.0/64.0, 46.0/64.0, 30.0/64.0, 33.0/64.0,17.0/64.0, 45.0/64.0, 29.0/64.0,
  10.0/64.0,58.0/64.0,  6.0/64.0, 54.0/64.0,  9.0/64.0,57.0/64.0,  5.0/64.0, 53.0/64.0,
  42.0/64.0,26.0/64.0, 38.0/64.0, 22.0/64.0, 41.0/64.0,25.0/64.0, 37.0/64.0, 21.0/64.0
);

vec3 dither(vec2 uv, vec3 color) {
  vec2 scaledCoord = floor(uv * resolution / pixelSize);
  int x = int(mod(scaledCoord.x, 8.0));
  int y = int(mod(scaledCoord.y, 8.0));
  float threshold = bayerMatrix8x8[y * 8 + x] - 0.25;
  float step = 1.0 / (colorNum - 1.0);
  color += threshold * step;
  float bias = 0.2;
  color = clamp(color - bias, 0.0, 1.0);
  return floor(color * (colorNum - 1.0) + 0.5) / (colorNum - 1.0);
}

void mainImage(in vec4 inputColor, in vec2 uv, out vec4 outputColor) {
  vec2 normalizedPixelSize = pixelSize / resolution;
  vec2 uvPixel = normalizedPixelSize * floor(uv / normalizedPixelSize);
  vec4 color = texture2D(inputBuffer, uvPixel);
  color.rgb = dither(uv, color.rgb);
  outputColor = color;
}
`;class xn extends it{constructor(){const e=new Map([["colorNum",new $(4)],["pixelSize",new $(2)]]);super("RetroEffect",gn,{uniforms:e}),this.uniforms=e}set colorNum(e){this.uniforms.get("colorNum").value=e}get colorNum(){return this.uniforms.get("colorNum").value}set pixelSize(e){this.uniforms.get("pixelSize").value=e}get pixelSize(){return this.uniforms.get("pixelSize").value}}const yn=pn(xn),Kt=D.forwardRef((t,e)=>{const{colorNum:s,pixelSize:i}=t;return f.jsx(yn,{ref:e,colorNum:s,pixelSize:i})});Kt.displayName="RetroEffect";function bn({waveSpeed:t,waveFrequency:e,waveAmplitude:s,waveColor:i,colorNum:r,pixelSize:n,disableAnimation:a,enableMouseInteraction:l,mouseRadius:o}){const c=D.useRef(null),h=D.useRef(new G),{viewport:d,size:v,gl:p}=at(),m=D.useRef({time:new $(0),resolution:new $(new G(0,0)),waveSpeed:new $(t),waveFrequency:new $(e),waveAmplitude:new $(s),waveColor:new $(new Te(...i)),mousePos:new $(new G(0,0)),enableMouseInteraction:new $(l?1:0),mouseRadius:new $(o)});D.useEffect(()=>{const b=p.getPixelRatio(),S=Math.floor(v.width*b),y=Math.floor(v.height*b),w=m.current.resolution.value;(w.x!==S||w.y!==y)&&w.set(S,y)},[v,p]);const g=D.useRef([...i]);Vt(({clock:b})=>{const S=m.current;a||(S.time.value=b.getElapsedTime()),S.waveSpeed.value!==t&&(S.waveSpeed.value=t),S.waveFrequency.value!==e&&(S.waveFrequency.value=e),S.waveAmplitude.value!==s&&(S.waveAmplitude.value=s),g.current.every((y,w)=>y===i[w])||(S.waveColor.value.set(...i),g.current=[...i]),S.enableMouseInteraction.value=l?1:0,S.mouseRadius.value=o,l&&S.mousePos.value.copy(h.current)});const x=b=>{if(!l)return;const S=p.domElement.getBoundingClientRect(),y=p.getPixelRatio();h.current.set((b.clientX-S.left)*y,(b.clientY-S.top)*y)};return f.jsxs(f.Fragment,{children:[f.jsxs("mesh",{ref:c,scale:[d.width,d.height,1],children:[f.jsx("planeGeometry",{args:[1,1]}),f.jsx("shaderMaterial",{vertexShader:vn,fragmentShader:mn,uniforms:m.current})]}),f.jsx(dn,{children:f.jsx(Kt,{colorNum:r,pixelSize:n})}),f.jsxs("mesh",{onPointerMove:x,position:[0,0,.01],scale:[d.width,d.height,1],visible:!1,children:[f.jsx("planeGeometry",{args:[1,1]}),f.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]})]})}function wn({waveSpeed:t=.05,waveFrequency:e=3,waveAmplitude:s=.3,waveColor:i=[.5,.5,.5],colorNum:r=4,pixelSize:n=2,disableAnimation:a=!1,enableMouseInteraction:l=!0,mouseRadius:o=1}){return f.jsx(gs,{className:"dither-container",style:{touchAction:"pan-y"},camera:{position:[0,0,6]},dpr:1,gl:{antialias:!0,preserveDrawingBuffer:!0},children:f.jsx(bn,{waveSpeed:t,waveFrequency:e,waveAmplitude:s,waveColor:i,colorNum:r,pixelSize:n,disableAnimation:a,enableMouseInteraction:l,mouseRadius:o})})}class te{constructor(e,s,i){this.x=e,this.y=s,this.z=i}dot2(e,s){return this.x*e+this.y*s}}class Sn{constructor(e=0){this.grad3=[new te(1,1,0),new te(-1,1,0),new te(1,-1,0),new te(-1,-1,0),new te(1,0,1),new te(-1,0,1),new te(1,0,-1),new te(-1,0,-1),new te(0,1,1),new te(0,-1,1),new te(0,1,-1),new te(0,-1,-1)],this.p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this.perm=new Array(512),this.gradP=new Array(512),this.seed(e)}seed(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(let s=0;s<256;s++){let i=s&1?this.p[s]^e&255:this.p[s]^e>>8&255;this.perm[s]=this.perm[s+256]=i,this.gradP[s]=this.gradP[s+256]=this.grad3[i%12]}}fade(e){return e*e*e*(e*(e*6-15)+10)}lerp(e,s,i){return(1-i)*e+i*s}perlin2(e,s){let i=Math.floor(e),r=Math.floor(s);e-=i,s-=r,i&=255,r&=255;const n=this.gradP[i+this.perm[r]].dot2(e,s),a=this.gradP[i+this.perm[r+1]].dot2(e,s-1),l=this.gradP[i+1+this.perm[r]].dot2(e-1,s),o=this.gradP[i+1+this.perm[r+1]].dot2(e-1,s-1),c=this.fade(e);return this.lerp(this.lerp(n,l,c),this.lerp(a,o,c),this.fade(s))}}const _n=({lineColor:t="black",backgroundColor:e="transparent",waveSpeedX:s=.0125,waveSpeedY:i=.005,waveAmpX:r=32,waveAmpY:n=16,xGap:a=20,yGap:l=40,friction:o=.925,tension:c=.005,maxCursorMove:h=100,style:d={},className:v=""})=>{const p=D.useRef(null),m=D.useRef(null),g=D.useRef(null),x=D.useRef({width:0,height:0,left:0,top:0}),b=D.useRef(new Sn(Math.random())),S=D.useRef([]),y=D.useRef({x:-10,y:0,lx:0,ly:0,sx:0,sy:0,v:0,vs:0,a:0,set:!1}),w=D.useRef({lineColor:t,waveSpeedX:s,waveSpeedY:i,waveAmpX:r,waveAmpY:n,friction:o,tension:c,maxCursorMove:h,xGap:a,yGap:l}),T=D.useRef(null);return D.useEffect(()=>{w.current={lineColor:t,waveSpeedX:s,waveSpeedY:i,waveAmpX:r,waveAmpY:n,friction:o,tension:c,maxCursorMove:h,xGap:a,yGap:l}},[t,s,i,r,n,o,c,h,a,l]),D.useEffect(()=>{console.log("Waves mounted");const E=m.current,O=p.current;g.current=E.getContext("2d");function C(){x.current=O.getBoundingClientRect(),E.width=x.current.width,E.height=x.current.height}function N(){const{width:B,height:F}=x.current;S.current=[];const L=B+200,W=F+30,{xGap:K,yGap:ae}=w.current,oe=Math.ceil(L/K),re=Math.ceil(W/ae),le=(B-K*oe)/2,me=(F-ae*re)/2;for(let Q=0;Q<=oe;Q++){const ge=[];for(let H=0;H<=re;H++)ge.push({x:le+K*Q,y:me+ae*H,wave:{x:0,y:0},cursor:{x:0,y:0,vx:0,vy:0}});S.current.push(ge)}}function R(B){const F=S.current,L=y.current,W=b.current,{waveSpeedX:K,waveSpeedY:ae,waveAmpX:oe,waveAmpY:re,friction:le,tension:me,maxCursorMove:Q}=w.current;F.forEach(ge=>{ge.forEach(H=>{const Re=W.perlin2((H.x+B*K)*.002,(H.y+B*ae)*.0015)*12;H.wave.x=Math.cos(Re)*oe,H.wave.y=Math.sin(Re)*re;const Ue=H.x-L.sx,Ge=H.y-L.sy,we=Math.hypot(Ue,Ge),xe=Math.max(175,L.vs);if(we<xe){const He=1-we/xe,Ae=Math.cos(we*.001)*He;H.cursor.vx+=Math.cos(L.a)*Ae*xe*L.vs*65e-5,H.cursor.vy+=Math.sin(L.a)*Ae*xe*L.vs*65e-5}H.cursor.vx+=(0-H.cursor.x)*me,H.cursor.vy+=(0-H.cursor.y)*me,H.cursor.vx*=le,H.cursor.vy*=le,H.cursor.x+=H.cursor.vx*2,H.cursor.y+=H.cursor.vy*2,H.cursor.x=Math.min(Q,Math.max(-Q,H.cursor.x)),H.cursor.y=Math.min(Q,Math.max(-Q,H.cursor.y))})})}function z(B,F=!0){const L=B.x+B.wave.x+(F?B.cursor.x:0),W=B.y+B.wave.y+(F?B.cursor.y:0);return{x:Math.round(L*10)/10,y:Math.round(W*10)/10}}function I(){const{width:B,height:F}=x.current,L=g.current;L.clearRect(0,0,B,F),L.beginPath(),L.strokeStyle=w.current.lineColor,S.current.forEach(W=>{let K=z(W[0],!1);L.moveTo(K.x,K.y),W.forEach((ae,oe)=>{const re=oe===W.length-1;K=z(ae,!re);const le=z(W[oe+1]||W[W.length-1],!re);L.lineTo(K.x,K.y),re&&L.moveTo(le.x,le.y)})}),L.stroke()}function k(B){const F=y.current;F.sx+=(F.x-F.sx)*.1,F.sy+=(F.y-F.sy)*.1;const L=F.x-F.lx,W=F.y-F.ly,K=Math.hypot(L,W);F.v=K,F.vs+=(K-F.vs)*.1,F.vs=Math.min(100,F.vs),F.lx=F.x,F.ly=F.y,F.a=Math.atan2(W,L),O.style.setProperty("--x",`${F.sx}px`),O.style.setProperty("--y",`${F.sy}px`),R(B),I(),T.current=requestAnimationFrame(k)}function M(){C(),N()}function Y(B){J(B.clientX,B.clientY)}function Z(B){const F=B.touches[0];J(F.clientX,F.clientY)}function J(B,F){const L=y.current,W=x.current;L.x=B-W.left,L.y=F-W.top,L.set||(L.sx=L.x,L.sy=L.y,L.lx=L.x,L.ly=L.y,L.set=!0)}return C(),N(),T.current=requestAnimationFrame(k),window.addEventListener("resize",M),window.addEventListener("mousemove",Y),window.addEventListener("touchmove",Z,{passive:!0}),()=>{window.removeEventListener("resize",M),window.removeEventListener("mousemove",Y),window.removeEventListener("touchmove",Z),cancelAnimationFrame(T.current)}},[]),f.jsx("div",{ref:p,className:`waves ${v}`,style:{position:"absolute",top:0,left:0,margin:0,padding:0,width:"100%",height:"100%",overflow:"hidden",backgroundColor:e,touchAction:"pan-y",...d},children:f.jsx("canvas",{ref:m,className:"waves-canvas"})})};function En({mouseForce:t=20,cursorSize:e=100,isViscous:s=!1,viscous:i=30,iterationsViscous:r=16,iterationsPoisson:n=16,dt:a=.014,BFECC:l=!0,resolution:o=.25,isBounce:c=!1,colors:h=["#5227FF","#FF9FFC","#B19EEF"],style:d={},className:v="",autoDemo:p=!0,autoSpeed:m=.5,autoIntensity:g=2.2,takeoverDuration:x=.25,autoResumeDelay:b=1e3,autoRampDuration:S=.6}){const y=D.useRef(null),w=D.useRef(null),T=D.useRef(null),E=D.useRef(null),O=D.useRef(null),C=D.useRef(!0),N=D.useRef(null);return D.useEffect(()=>{if(!y.current)return;function R(j){let u;Array.isArray(j)&&j.length>0?j.length===1?u=[j[0],j[0]]:u=j:u=["#ffffff","#ffffff"];const _=u.length,A=new Uint8Array(_*4);for(let X=0;X<_;X++){const ee=new Te(u[X]);A[X*4+0]=Math.round(ee.r*255),A[X*4+1]=Math.round(ee.g*255),A[X*4+2]=Math.round(ee.b*255),A[X*4+3]=255}const V=new xs(A,_,1,ys);return V.magFilter=de,V.minFilter=de,V.wrapS=ze,V.wrapT=ze,V.generateMipmaps=!1,V.needsUpdate=!0,V}const z=R(h),I=new Ss(0,0,0,0);class k{constructor(){this.width=0,this.height=0,this.aspect=1,this.pixelRatio=1,this.isMobile=!1,this.breakpoint=768,this.fboWidth=null,this.fboHeight=null,this.time=0,this.delta=0,this.container=null,this.renderer=null,this.clock=null}init(u){this.container=u,this.pixelRatio=Math.min(window.devicePixelRatio||1,2),this.resize(),this.renderer=new bs({antialias:!0,alpha:!0}),this.renderer.autoClear=!1,this.renderer.setClearColor(new Te(0),0),this.renderer.setPixelRatio(this.pixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.display="block",this.clock=new ws,this.clock.start()}resize(){if(!this.container)return;const u=this.container.getBoundingClientRect();this.width=Math.max(1,Math.floor(u.width)),this.height=Math.max(1,Math.floor(u.height)),this.aspect=this.width/this.height,this.renderer&&this.renderer.setSize(this.width,this.height,!1)}update(){this.delta=this.clock.getDelta(),this.time+=this.delta}}const M=new k;class Y{constructor(){this.mouseMoved=!1,this.coords=new G,this.coords_old=new G,this.diff=new G,this.timer=null,this.container=null,this.docTarget=null,this.listenerTarget=null,this.isHoverInside=!1,this.hasUserControl=!1,this.isAutoActive=!1,this.autoIntensity=2,this.takeoverActive=!1,this.takeoverStartTime=0,this.takeoverDuration=.25,this.takeoverFrom=new G,this.takeoverTo=new G,this.onInteract=null,this._onMouseMove=this.onDocumentMouseMove.bind(this),this._onTouchStart=this.onDocumentTouchStart.bind(this),this._onTouchMove=this.onDocumentTouchMove.bind(this),this._onTouchEnd=this.onTouchEnd.bind(this),this._onDocumentLeave=this.onDocumentLeave.bind(this)}init(u){this.container=u,this.docTarget=u.ownerDocument||null;const _=this.docTarget&&this.docTarget.defaultView||(typeof window<"u"?window:null);_&&(this.listenerTarget=_,this.listenerTarget.addEventListener("mousemove",this._onMouseMove),this.listenerTarget.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.listenerTarget.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.listenerTarget.addEventListener("touchend",this._onTouchEnd),this.docTarget&&this.docTarget.addEventListener("mouseleave",this._onDocumentLeave))}dispose(){this.listenerTarget&&(this.listenerTarget.removeEventListener("mousemove",this._onMouseMove),this.listenerTarget.removeEventListener("touchstart",this._onTouchStart),this.listenerTarget.removeEventListener("touchmove",this._onTouchMove),this.listenerTarget.removeEventListener("touchend",this._onTouchEnd)),this.docTarget&&this.docTarget.removeEventListener("mouseleave",this._onDocumentLeave),this.listenerTarget=null,this.docTarget=null,this.container=null}isPointInside(u,_){if(!this.container)return!1;const A=this.container.getBoundingClientRect();return A.width===0||A.height===0?!1:u>=A.left&&u<=A.right&&_>=A.top&&_<=A.bottom}updateHoverState(u,_){return this.isHoverInside=this.isPointInside(u,_),this.isHoverInside}setCoords(u,_){if(!this.container)return;this.timer&&window.clearTimeout(this.timer);const A=this.container.getBoundingClientRect();if(A.width===0||A.height===0)return;const V=(u-A.left)/A.width,X=(_-A.top)/A.height;this.coords.set(V*2-1,-(X*2-1)),this.mouseMoved=!0,this.timer=window.setTimeout(()=>{this.mouseMoved=!1},100)}setNormalized(u,_){this.coords.set(u,_),this.mouseMoved=!0}onDocumentMouseMove(u){if(this.updateHoverState(u.clientX,u.clientY)){if(this.onInteract&&this.onInteract(),this.isAutoActive&&!this.hasUserControl&&!this.takeoverActive){if(!this.container)return;const _=this.container.getBoundingClientRect();if(_.width===0||_.height===0)return;const A=(u.clientX-_.left)/_.width,V=(u.clientY-_.top)/_.height;this.takeoverFrom.copy(this.coords),this.takeoverTo.set(A*2-1,-(V*2-1)),this.takeoverStartTime=performance.now(),this.takeoverActive=!0,this.hasUserControl=!0,this.isAutoActive=!1;return}this.setCoords(u.clientX,u.clientY),this.hasUserControl=!0}}onDocumentTouchStart(u){if(u.touches.length!==1)return;const _=u.touches[0];this.updateHoverState(_.clientX,_.clientY)&&(this.onInteract&&this.onInteract(),this.setCoords(_.clientX,_.clientY),this.hasUserControl=!0)}onDocumentTouchMove(u){if(u.touches.length!==1)return;const _=u.touches[0];this.updateHoverState(_.clientX,_.clientY)&&(this.onInteract&&this.onInteract(),this.setCoords(_.clientX,_.clientY))}onTouchEnd(){this.isHoverInside=!1}onDocumentLeave(){this.isHoverInside=!1}update(){if(this.takeoverActive){const u=(performance.now()-this.takeoverStartTime)/(this.takeoverDuration*1e3);if(u>=1)this.takeoverActive=!1,this.coords.copy(this.takeoverTo),this.coords_old.copy(this.coords),this.diff.set(0,0);else{const _=u*u*(3-2*u);this.coords.copy(this.takeoverFrom).lerp(this.takeoverTo,_)}}this.diff.subVectors(this.coords,this.coords_old),this.coords_old.copy(this.coords),this.coords_old.x===0&&this.coords_old.y===0&&this.diff.set(0,0),this.isAutoActive&&!this.takeoverActive&&this.diff.multiplyScalar(this.autoIntensity)}}const Z=new Y;class J{constructor(u,_,A){this.mouse=u,this.manager=_,this.enabled=A.enabled,this.speed=A.speed,this.resumeDelay=A.resumeDelay||3e3,this.rampDurationMs=(A.rampDuration||0)*1e3,this.active=!1,this.current=new G(0,0),this.target=new G,this.lastTime=performance.now(),this.activationTime=0,this.margin=.2,this._tmpDir=new G,this.pickNewTarget()}pickNewTarget(){const u=Math.random;this.target.set((u()*2-1)*(1-this.margin),(u()*2-1)*(1-this.margin))}forceStop(){this.active=!1,this.mouse.isAutoActive=!1}update(){if(!this.enabled)return;const u=performance.now();if(u-this.manager.lastUserInteraction<this.resumeDelay){this.active&&this.forceStop();return}if(this.mouse.isHoverInside){this.active&&this.forceStop();return}if(this.active||(this.active=!0,this.current.copy(this.mouse.coords),this.lastTime=u,this.activationTime=u),!this.active)return;this.mouse.isAutoActive=!0;let A=(u-this.lastTime)/1e3;this.lastTime=u,A>.2&&(A=.016);const V=this._tmpDir.subVectors(this.target,this.current),X=V.length();if(X<.01){this.pickNewTarget();return}V.normalize();let ee=1;if(this.rampDurationMs>0){const Ve=Math.min(1,(u-this.activationTime)/this.rampDurationMs);ee=Ve*Ve*(3-2*Ve)}const je=this.speed*A*ee,Se=Math.min(je,X);this.current.addScaledVector(V,Se),this.mouse.setNormalized(this.current.x,this.current.y)}}const B=`
  attribute vec3 position;
  uniform vec2 px;
  uniform vec2 boundarySpace;
  varying vec2 uv;
  precision highp float;
  void main(){
  vec3 pos = position;
  vec2 scale = 1.0 - boundarySpace * 2.0;
  pos.xy = pos.xy * scale;
  uv = vec2(0.5)+(pos.xy)*0.5;
  gl_Position = vec4(pos, 1.0);
}
`,F=`
  attribute vec3 position;
  uniform vec2 px;
  precision highp float;
  varying vec2 uv;
  void main(){
  vec3 pos = position;
  uv = 0.5 + pos.xy * 0.5;
  vec2 n = sign(pos.xy);
  pos.xy = abs(pos.xy) - px * 1.0;
  pos.xy *= n;
  gl_Position = vec4(pos, 1.0);
}
`,L=`
    precision highp float;
    attribute vec3 position;
    attribute vec2 uv;
    uniform vec2 center;
    uniform vec2 scale;
    uniform vec2 px;
    varying vec2 vUv;
    void main(){
    vec2 pos = position.xy * scale * 2.0 * px + center;
    vUv = uv;
    gl_Position = vec4(pos, 0.0, 1.0);
}
`,W=`
    precision highp float;
    uniform sampler2D velocity;
    uniform float dt;
    uniform bool isBFECC;
    uniform vec2 fboSize;
    uniform vec2 px;
    varying vec2 uv;
    void main(){
    vec2 ratio = max(fboSize.x, fboSize.y) / fboSize;
    if(isBFECC == false){
        vec2 vel = texture2D(velocity, uv).xy;
        vec2 uv2 = uv - vel * dt * ratio;
        vec2 newVel = texture2D(velocity, uv2).xy;
        gl_FragColor = vec4(newVel, 0.0, 0.0);
    } else {
        vec2 spot_new = uv;
        vec2 vel_old = texture2D(velocity, uv).xy;
        vec2 spot_old = spot_new - vel_old * dt * ratio;
        vec2 vel_new1 = texture2D(velocity, spot_old).xy;
        vec2 spot_new2 = spot_old + vel_new1 * dt * ratio;
        vec2 error = spot_new2 - spot_new;
        vec2 spot_new3 = spot_new - error / 2.0;
        vec2 vel_2 = texture2D(velocity, spot_new3).xy;
        vec2 spot_old2 = spot_new3 - vel_2 * dt * ratio;
        vec2 newVel2 = texture2D(velocity, spot_old2).xy; 
        gl_FragColor = vec4(newVel2, 0.0, 0.0);
    }
}
`,K=`
    precision highp float;
    uniform sampler2D velocity;
    uniform sampler2D palette;
    uniform vec4 bgColor;
    varying vec2 uv;
    void main(){
    vec2 vel = texture2D(velocity, uv).xy;
    float lenv = clamp(length(vel), 0.0, 1.0);
    vec3 c = texture2D(palette, vec2(lenv, 0.5)).rgb;
    vec3 outRGB = mix(bgColor.rgb, c, lenv);
    float outA = mix(bgColor.a, 1.0, lenv);
    gl_FragColor = vec4(outRGB, outA);
}
`,ae=`
    precision highp float;
    uniform sampler2D velocity;
    uniform float dt;
    uniform vec2 px;
    varying vec2 uv;
    void main(){
    float x0 = texture2D(velocity, uv-vec2(px.x, 0.0)).x;
    float x1 = texture2D(velocity, uv+vec2(px.x, 0.0)).x;
    float y0 = texture2D(velocity, uv-vec2(0.0, px.y)).y;
    float y1 = texture2D(velocity, uv+vec2(0.0, px.y)).y;
    float divergence = (x1 - x0 + y1 - y0) / 2.0;
    gl_FragColor = vec4(divergence / dt);
}
`,oe=`
    precision highp float;
    uniform vec2 force;
    uniform vec2 center;
    uniform vec2 scale;
    uniform vec2 px;
    varying vec2 vUv;
    void main(){
    vec2 circle = (vUv - 0.5) * 2.0;
    float d = 1.0 - min(length(circle), 1.0);
    d *= d;
    gl_FragColor = vec4(force * d, 0.0, 1.0);
}
`,re=`
    precision highp float;
    uniform sampler2D pressure;
    uniform sampler2D divergence;
    uniform vec2 px;
    varying vec2 uv;
    void main(){
    float p0 = texture2D(pressure, uv + vec2(px.x * 2.0, 0.0)).r;
    float p1 = texture2D(pressure, uv - vec2(px.x * 2.0, 0.0)).r;
    float p2 = texture2D(pressure, uv + vec2(0.0, px.y * 2.0)).r;
    float p3 = texture2D(pressure, uv - vec2(0.0, px.y * 2.0)).r;
    float div = texture2D(divergence, uv).r;
    float newP = (p0 + p1 + p2 + p3) / 4.0 - div;
    gl_FragColor = vec4(newP);
}
`,le=`
    precision highp float;
    uniform sampler2D pressure;
    uniform sampler2D velocity;
    uniform vec2 px;
    uniform float dt;
    varying vec2 uv;
    void main(){
    float step = 1.0;
    float p0 = texture2D(pressure, uv + vec2(px.x * step, 0.0)).r;
    float p1 = texture2D(pressure, uv - vec2(px.x * step, 0.0)).r;
    float p2 = texture2D(pressure, uv + vec2(0.0, px.y * step)).r;
    float p3 = texture2D(pressure, uv - vec2(0.0, px.y * step)).r;
    vec2 v = texture2D(velocity, uv).xy;
    vec2 gradP = vec2(p0 - p1, p2 - p3) * 0.5;
    v = v - gradP * dt;
    gl_FragColor = vec4(v, 0.0, 1.0);
}
`,me=`
    precision highp float;
    uniform sampler2D velocity;
    uniform sampler2D velocity_new;
    uniform float v;
    uniform vec2 px;
    uniform float dt;
    varying vec2 uv;
    void main(){
    vec2 old = texture2D(velocity, uv).xy;
    vec2 new0 = texture2D(velocity_new, uv + vec2(px.x * 2.0, 0.0)).xy;
    vec2 new1 = texture2D(velocity_new, uv - vec2(px.x * 2.0, 0.0)).xy;
    vec2 new2 = texture2D(velocity_new, uv + vec2(0.0, px.y * 2.0)).xy;
    vec2 new3 = texture2D(velocity_new, uv - vec2(0.0, px.y * 2.0)).xy;
    vec2 newv = 4.0 * old + v * dt * (new0 + new1 + new2 + new3);
    newv /= 4.0 * (1.0 + v * dt);
    gl_FragColor = vec4(newv, 0.0, 0.0);
}
`;class Q{constructor(u){var _;this.props=u||{},this.uniforms=(_=this.props.material)==null?void 0:_.uniforms,this.scene=null,this.camera=null,this.material=null,this.geometry=null,this.plane=null}init(){this.scene=new Oe,this.camera=new ut,this.uniforms&&(this.material=new Ne(this.props.material),this.geometry=new $e(2,2),this.plane=new Fe(this.geometry,this.material),this.scene.add(this.plane))}update(){M.renderer.setRenderTarget(this.props.output||null),M.renderer.render(this.scene,this.camera),M.renderer.setRenderTarget(null)}}class ge extends Q{constructor(u){super({material:{vertexShader:B,fragmentShader:W,uniforms:{boundarySpace:{value:u.cellScale},px:{value:u.cellScale},fboSize:{value:u.fboSize},velocity:{value:u.src.texture},dt:{value:u.dt},isBFECC:{value:!0}}},output:u.dst}),this.uniforms=this.props.material.uniforms,this.init()}init(){super.init(),this.createBoundary()}createBoundary(){const u=new Ht,_=new Float32Array([-1,-1,0,-1,1,0,-1,1,0,1,1,0,1,1,0,1,-1,0,1,-1,0,-1,-1,0]);u.setAttribute("position",new Je(_,3));const A=new Ne({vertexShader:F,fragmentShader:W,uniforms:this.uniforms});this.line=new _s(u,A),this.scene.add(this.line)}update({dt:u,isBounce:_,BFECC:A}){this.uniforms.dt.value=u,this.line.visible=_,this.uniforms.isBFECC.value=A,super.update()}}class H extends Q{constructor(u){super({output:u.dst}),this.init(u)}init(u){super.init();const _=new $e(1,1),A=new Ne({vertexShader:L,fragmentShader:oe,blending:Es,depthWrite:!1,uniforms:{px:{value:u.cellScale},force:{value:new G(0,0)},center:{value:new G(0,0)},scale:{value:new G(u.cursor_size,u.cursor_size)}}});this.mouse=new Fe(_,A),this.scene.add(this.mouse)}update(u){const _=Z.diff.x/2*u.mouse_force,A=Z.diff.y/2*u.mouse_force,V=u.cursor_size*u.cellScale.x,X=u.cursor_size*u.cellScale.y,ee=Math.min(Math.max(Z.coords.x,-1+V+u.cellScale.x*2),1-V-u.cellScale.x*2),je=Math.min(Math.max(Z.coords.y,-1+X+u.cellScale.y*2),1-X-u.cellScale.y*2),Se=this.mouse.material.uniforms;Se.force.value.set(_,A),Se.center.value.set(ee,je),Se.scale.value.set(u.cursor_size,u.cursor_size),super.update()}}class Re extends Q{constructor(u){super({material:{vertexShader:B,fragmentShader:me,uniforms:{boundarySpace:{value:u.boundarySpace},velocity:{value:u.src.texture},velocity_new:{value:u.dst_.texture},v:{value:u.viscous},px:{value:u.cellScale},dt:{value:u.dt}}},output:u.dst,output0:u.dst_,output1:u.dst}),this.init()}update({viscous:u,iterations:_,dt:A}){let V,X;this.uniforms.v.value=u;for(let ee=0;ee<_;ee++)ee%2===0?(V=this.props.output0,X=this.props.output1):(V=this.props.output1,X=this.props.output0),this.uniforms.velocity_new.value=V.texture,this.props.output=X,this.uniforms.dt.value=A,super.update();return X}}class Ue extends Q{constructor(u){super({material:{vertexShader:B,fragmentShader:ae,uniforms:{boundarySpace:{value:u.boundarySpace},velocity:{value:u.src.texture},px:{value:u.cellScale},dt:{value:u.dt}}},output:u.dst}),this.init()}update({vel:u}){this.uniforms.velocity.value=u.texture,super.update()}}class Ge extends Q{constructor(u){super({material:{vertexShader:B,fragmentShader:re,uniforms:{boundarySpace:{value:u.boundarySpace},pressure:{value:u.dst_.texture},divergence:{value:u.src.texture},px:{value:u.cellScale}}},output:u.dst,output0:u.dst_,output1:u.dst}),this.init()}update({iterations:u}){let _,A;for(let V=0;V<u;V++)V%2===0?(_=this.props.output0,A=this.props.output1):(_=this.props.output1,A=this.props.output0),this.uniforms.pressure.value=_.texture,this.props.output=A,super.update();return A}}class we extends Q{constructor(u){super({material:{vertexShader:B,fragmentShader:le,uniforms:{boundarySpace:{value:u.boundarySpace},pressure:{value:u.src_p.texture},velocity:{value:u.src_v.texture},px:{value:u.cellScale},dt:{value:u.dt}}},output:u.dst}),this.init()}update({vel:u,pressure:_}){this.uniforms.velocity.value=u.texture,this.uniforms.pressure.value=_.texture,super.update()}}class xe{constructor(u){this.options={iterations_poisson:32,iterations_viscous:32,mouse_force:20,resolution:.5,cursor_size:100,viscous:30,isBounce:!1,dt:.014,isViscous:!1,BFECC:!0,...u},this.fbos={vel_0:null,vel_1:null,vel_viscous0:null,vel_viscous1:null,div:null,pressure_0:null,pressure_1:null},this.fboSize=new G,this.cellScale=new G,this.boundarySpace=new G,this.init()}init(){this.calcSize(),this.createAllFBO(),this.createShaderPass()}getFloatType(){return/(iPad|iPhone|iPod)/i.test(navigator.userAgent)?jt:Ot}createAllFBO(){const _={type:this.getFloatType(),depthBuffer:!1,stencilBuffer:!1,minFilter:de,magFilter:de,wrapS:ze,wrapT:ze};for(let A in this.fbos)this.fbos[A]=new ve(this.fboSize.x,this.fboSize.y,_)}createShaderPass(){this.advection=new ge({cellScale:this.cellScale,fboSize:this.fboSize,dt:this.options.dt,src:this.fbos.vel_0,dst:this.fbos.vel_1}),this.externalForce=new H({cellScale:this.cellScale,cursor_size:this.options.cursor_size,dst:this.fbos.vel_1}),this.viscous=new Re({cellScale:this.cellScale,boundarySpace:this.boundarySpace,viscous:this.options.viscous,src:this.fbos.vel_1,dst:this.fbos.vel_viscous1,dst_:this.fbos.vel_viscous0,dt:this.options.dt}),this.divergence=new Ue({cellScale:this.cellScale,boundarySpace:this.boundarySpace,src:this.fbos.vel_viscous0,dst:this.fbos.div,dt:this.options.dt}),this.poisson=new Ge({cellScale:this.cellScale,boundarySpace:this.boundarySpace,src:this.fbos.div,dst:this.fbos.pressure_1,dst_:this.fbos.pressure_0}),this.pressure=new we({cellScale:this.cellScale,boundarySpace:this.boundarySpace,src_p:this.fbos.pressure_0,src_v:this.fbos.vel_viscous0,dst:this.fbos.vel_0,dt:this.options.dt})}calcSize(){const u=Math.max(1,Math.round(this.options.resolution*M.width)),_=Math.max(1,Math.round(this.options.resolution*M.height)),A=1/u,V=1/_;this.cellScale.set(A,V),this.fboSize.set(u,_)}resize(){this.calcSize();for(let u in this.fbos)this.fbos[u].setSize(this.fboSize.x,this.fboSize.y)}update(){this.options.isBounce?this.boundarySpace.set(0,0):this.boundarySpace.copy(this.cellScale),this.advection.update({dt:this.options.dt,isBounce:this.options.isBounce,BFECC:this.options.BFECC}),this.externalForce.update({cursor_size:this.options.cursor_size,mouse_force:this.options.mouse_force,cellScale:this.cellScale});let u=this.fbos.vel_1;this.options.isViscous&&(u=this.viscous.update({viscous:this.options.viscous,iterations:this.options.iterations_viscous,dt:this.options.dt})),this.divergence.update({vel:u});const _=this.poisson.update({iterations:this.options.iterations_poisson});this.pressure.update({vel:u,pressure:_})}}class He{constructor(){this.init()}init(){this.simulation=new xe,this.scene=new Oe,this.camera=new ut,this.output=new Fe(new $e(2,2),new Ne({vertexShader:B,fragmentShader:K,transparent:!0,depthWrite:!1,uniforms:{velocity:{value:this.simulation.fbos.vel_0.texture},boundarySpace:{value:new G},palette:{value:z},bgColor:{value:I}}})),this.scene.add(this.output)}addScene(u){this.scene.add(u)}resize(){this.simulation.resize()}render(){M.renderer.setRenderTarget(null),M.renderer.render(this.scene,this.camera)}update(){this.simulation.update(),this.render()}}class Ae{constructor(u){this.props=u,M.init(u.$wrapper),Z.init(u.$wrapper),Z.autoIntensity=u.autoIntensity,Z.takeoverDuration=u.takeoverDuration,this.lastUserInteraction=performance.now(),Z.onInteract=()=>{this.lastUserInteraction=performance.now(),this.autoDriver&&this.autoDriver.forceStop()},this.autoDriver=new J(Z,this,{enabled:u.autoDemo,speed:u.autoSpeed,resumeDelay:u.autoResumeDelay,rampDuration:u.autoRampDuration}),this.init(),this._loop=this.loop.bind(this),this._resize=this.resize.bind(this),window.addEventListener("resize",this._resize),this._onVisibility=()=>{document.hidden?this.pause():C.current&&this.start()},document.addEventListener("visibilitychange",this._onVisibility),this.running=!1}init(){this.props.$wrapper.prepend(M.renderer.domElement),this.output=new He}resize(){M.resize(),this.output.resize()}render(){this.autoDriver&&this.autoDriver.update(),Z.update(),M.update(),this.output.update()}loop(){this.running&&(this.render(),E.current=requestAnimationFrame(this._loop))}start(){this.running||(this.running=!0,this._loop())}pause(){this.running=!1,E.current&&(cancelAnimationFrame(E.current),E.current=null)}dispose(){try{if(window.removeEventListener("resize",this._resize),document.removeEventListener("visibilitychange",this._onVisibility),Z.dispose(),M.renderer){const u=M.renderer.domElement;u&&u.parentNode&&u.parentNode.removeChild(u),M.renderer.dispose()}}catch{}}}const pe=y.current;pe.style.position=pe.style.position||"relative",pe.style.overflow=pe.style.overflow||"hidden";const ot=new Ae({$wrapper:pe,autoDemo:p,autoSpeed:m,autoIntensity:g,takeoverDuration:x,autoResumeDelay:b,autoRampDuration:S});w.current=ot,(()=>{var _;if(!w.current)return;const j=(_=w.current.output)==null?void 0:_.simulation;if(!j)return;const u=j.options.resolution;Object.assign(j.options,{mouse_force:t,cursor_size:e,isViscous:s,viscous:i,iterations_viscous:r,iterations_poisson:n,dt:a,BFECC:l,resolution:o,isBounce:c}),o!==u&&j.resize()})(),ot.start();const lt=new IntersectionObserver(j=>{const u=j[0],_=u.isIntersecting&&u.intersectionRatio>0;C.current=_,w.current&&(_&&!document.hidden?w.current.start():w.current.pause())},{threshold:[0,.01,.1]});lt.observe(pe),O.current=lt;const ct=new ResizeObserver(()=>{w.current&&(N.current&&cancelAnimationFrame(N.current),N.current=requestAnimationFrame(()=>{w.current&&w.current.resize()}))});return ct.observe(pe),T.current=ct,()=>{if(E.current&&cancelAnimationFrame(E.current),T.current)try{T.current.disconnect()}catch{}if(O.current)try{O.current.disconnect()}catch{}w.current&&w.current.dispose(),w.current=null}},[l,e,a,c,s,n,r,t,o,i,h,p,m,g,x,b,S]),D.useEffect(()=>{var k;const R=w.current;if(!R)return;const z=(k=R.output)==null?void 0:k.simulation;if(!z)return;const I=z.options.resolution;Object.assign(z.options,{mouse_force:t,cursor_size:e,isViscous:s,viscous:i,iterations_viscous:r,iterations_poisson:n,dt:a,BFECC:l,resolution:o,isBounce:c}),R.autoDriver&&(R.autoDriver.enabled=p,R.autoDriver.speed=m,R.autoDriver.resumeDelay=b,R.autoDriver.rampDurationMs=S*1e3,R.autoDriver.mouse&&(R.autoDriver.mouse.autoIntensity=g,R.autoDriver.mouse.takeoverDuration=x)),o!==I&&z.resize()},[t,e,s,i,r,n,a,l,o,c,p,m,g,x,b,S]),f.jsx("div",{ref:y,className:`liquid-ether-container ${v||""}`,style:{touchAction:"pan-y",...d}})}const Ie=({children:t,delay:e=0,className:s="",start:i=!0})=>{const r=typeof t=="string"?t:null,n={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.03,delayChildren:e}}},a={hidden:{opacity:0,y:5},visible:{opacity:1,y:0}};if(r)return f.jsx(q.div,{className:s,variants:n,initial:"hidden",animate:i?"visible":"hidden",children:r.split("").map((o,c)=>f.jsx(q.span,{variants:a,children:o},c))});const l=o=>{if(typeof o=="string")return o.split("").map((c,h)=>f.jsx(q.span,{variants:a,className:"inline-block whitespace-pre",children:c},h));if(fe.isValidElement(o)){const{children:c,...h}=o.props;return fe.cloneElement(o,{...h,key:Math.random()},Array.isArray(c)?c.map(l):l(c))}return o};return f.jsx(q.div,{className:`flex flex-wrap ${s}`,variants:n,initial:"hidden",animate:i?"visible":"hidden",children:fe.Children.map(t,l)})},Dn=({title:t="AXIOMATIC",subtitle:e,theme:s="default",startAnimation:i=!0})=>{const[r,n]=fe.useState(!1);fe.useEffect(()=>{const d=()=>{n(window.matchMedia("(max-width: 768px)").matches||window.matchMedia("(pointer: coarse)").matches)};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]);const{scrollY:a}=ts(),l=ht(a,[0,500],[0,100]),o=ht(a,[0,300],[1,0]),c=new Date,h=`${String(c.getDate()).padStart(2,"0")}/${String(c.getMonth()+1).padStart(2,"0")}/${String(c.getFullYear()).slice(-2)}`;return f.jsxs("section",{className:"relative h-screen flex items-center justify-center overflow-hidden bg-cyber-black",children:[f.jsxs("div",{className:"absolute inset-0 z-0",children:[s==="science"&&f.jsx(lr,{}),s==="engineering"&&f.jsx(wn,{}),s==="philosophy"&&f.jsx(_n,{lineColor:"rgba(167, 139, 250, 0.5)"}),s==="personal"&&f.jsxs("div",{className:"absolute inset-0",children:[f.jsx(En,{colors:["#FF0000","#8B0000","#FF4D4D"],mouseForce:20,cursorSize:100,isViscous:!1,viscous:30,iterationsViscous:32,iterationsPoisson:32,resolution:.5,isBounce:!1,autoDemo:!0,autoSpeed:.5,autoIntensity:2.2,takeoverDuration:.25,autoResumeDelay:3e3,autoRampDuration:.6}),f.jsx("div",{className:"absolute inset-0 bg-cyber-black/40 pointer-events-none"})]})]}),f.jsx("div",{className:"absolute inset-0 cyber-grid-bg opacity-20 pointer-events-none"}),f.jsx("div",{className:"absolute inset-0 scanline opacity-10 pointer-events-none"}),f.jsxs(q.div,{style:{y:l,opacity:o},className:"relative z-10 text-center px-4 max-w-7xl mx-auto w-full flex flex-col items-center justify-center pointer-events-none",children:[f.jsxs(q.div,{initial:{opacity:0,y:10},animate:i?{opacity:1,y:0}:{opacity:0,y:10},transition:{duration:.5},className:"font-mono text-cyber-text mb-6 tracking-widest text-xs border-b border-cyber-border inline-block pb-1",children:[s==="personal"?"FROM_WITHIN":"FROM_AXIOMS"," // ",h]}),f.jsx(q.h1,{initial:{opacity:0,scale:.95},animate:i?{opacity:1,scale:1}:{opacity:0,scale:.95},transition:{duration:.8,ease:[.16,1,.3,1]},className:`text-4xl max-[530px]:text-3xl md:text-8xl font-display font-extrabold tracking-tighter mb-8 uppercase ${s==="science"?"text-cyan-400":s==="engineering"?"text-amber-400":s==="philosophy"?"text-violet-400":s==="personal"?"text-red-500":"text-cyber-white"}`,children:t}),f.jsx("div",{className:"max-w-2xl mx-auto text-center md:text-left font-sans text-sm md:text-lg leading-loose text-cyber-text/80 space-y-2",children:e||f.jsxs("div",{className:"max-w-2xl mx-auto text-center font-sans text-sm md:text-lg leading-loose text-cyber-text/80 space-y-2",children:[f.jsx(Ie,{delay:.2,start:i,className:"justify-center",children:f.jsxs("p",{children:[f.jsx("span",{className:"text-cyber-white font-bold text-lg md:text-2xl inline-block animate-pulse-slow",children:"axiomatic"}),f.jsx("span",{className:"mx-3 text-cyber-border",children:"|"}),f.jsx("span",{className:"italic text-base md:text-xl",children:"(adj.)"})]})}),f.jsx(Ie,{delay:.6,start:i,className:"justify-center",children:f.jsx("p",{children:"1. self-evident or unquestionable."})}),f.jsx(Ie,{delay:1,start:i,className:"justify-center",children:f.jsx("p",{children:"2. relating to or containing axioms."})})]})})]}),f.jsx(q.div,{style:{opacity:o},className:`absolute bottom-10 left-1/2 -translate-x-1/2 animate-pulse ${s==="science"?"text-cyan-400":s==="engineering"?"text-amber-400":s==="philosophy"?"text-violet-400":s==="personal"?"text-red-500":"text-cyber-text"}`,children:f.jsx("span",{className:"font-mono text-xs tracking-widest",children:"SCROLL_TO_READ"})})]})},zn=({post:t,onClick:e,forceWhite:s=!1,disableHoverLift:i=!1})=>{Ms();const n=(a=>{if(s)return"text-cyber-white group-hover:text-cyber-white/80";switch(a){case"SCIENCE":return"text-cyan-400 group-hover:text-cyan-300";case"ENGINEERING":return"text-amber-400 group-hover:text-amber-300";case"PHILOSOPHY":return"text-violet-400 group-hover:text-violet-300";case"PERSONAL":return"text-red-500 group-hover:text-red-400";default:return"text-cyber-white"}})(t.category);return f.jsx(q.div,{variants:{hidden:{opacity:0,y:50,scale:.9,rotateX:-10},visible:{opacity:1,y:0,scale:1,rotateX:0,transition:{type:"spring",stiffness:100,damping:20,duration:.6}}},className:"h-full perspective-1000",children:f.jsxs(q.article,{onClick:e,className:"group relative h-full bg-cyber-dark border border-cyber-border p-6 cursor-pointer overflow-hidden transition-all hover:border-cyber-white flex flex-col",whileHover:i?{}:{y:-5},whileTap:{scale:.98},children:[f.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-0 group-hover:opacity-100 transition-opacity",children:f.jsx(Ts,{className:`w-4 h-4 -rotate-45 ${n}`})}),f.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[f.jsxs("div",{className:"flex justify-between items-start mb-8 font-mono text-xs text-cyber-text border-b border-cyber-border pb-2",children:[f.jsx("span",{className:n.split(" ")[0],children:t.category}),f.jsx("span",{children:t.date})]}),f.jsx("h3",{className:`text-xl font-bold mb-4 leading-tight ${n} decoration-1 underline-offset-4`,children:t.title}),f.jsx("p",{className:"text-cyber-text text-sm leading-relaxed mb-8 flex-grow font-mono",children:t.excerpt}),f.jsxs("div",{className:"flex items-center gap-2 text-xs font-mono text-cyber-text group-hover:text-cyber-white transition-colors",children:[f.jsx("div",{className:"w-2 h-2 bg-cyber-border group-hover:bg-cyber-white transition-colors"}),f.jsxs("span",{children:["READ_TIME: ",t.readTime]})]})]})]})})},Mn=({url:t,title:e,description:s})=>{const[i,r]=D.useState(!1),[n,a]=D.useState(!1),l=D.useRef(null);D.useEffect(()=>{const h=d=>{l.current&&!l.current.contains(d.target)&&r(!1)};if(i)return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[i]);const c=[{name:"Copy Link",icon:n?dt:As,onClick:async()=>{try{await navigator.clipboard.writeText(t),a(!0),setTimeout(()=>{a(!1),r(!1)},2e3)}catch{const d=document.createElement("textarea");d.value=t,d.style.position="fixed",d.style.left="-999999px",document.body.appendChild(d),d.select();try{document.execCommand("copy"),a(!0),setTimeout(()=>{a(!1),r(!1)},2e3)}catch(v){console.error("Failed to copy:",v)}document.body.removeChild(d)}},color:"text-cyan-400"},{name:"Twitter",icon:Is,onClick:()=>{window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(e)}&url=${encodeURIComponent(t)}`,"_blank","noopener,noreferrer"),r(!1)},color:"text-[#1DA1F2]"},{name:"LinkedIn",icon:Cs,onClick:()=>{window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(t)}`,"_blank","noopener,noreferrer"),r(!1)},color:"text-[#0A66C2]"},{name:"Facebook",icon:Rs,onClick:()=>{window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(t)}`,"_blank","noopener,noreferrer"),r(!1)},color:"text-[#1877F2]"},{name:"Email",icon:Ds,onClick:()=>{window.location.href=`mailto:?subject=${encodeURIComponent(e)}&body=${encodeURIComponent(`${s||"Check out this article"}: ${t}`)}`,r(!1)},color:"text-purple-400"},{name:"WhatsApp",icon:zs,onClick:()=>{window.open(`https://wa.me/?text=${encodeURIComponent(`${e} ${t}`)}`,"_blank","noopener,noreferrer"),r(!1)},color:"text-[#25D366]"}];return f.jsxs("div",{className:"relative",ref:l,children:[f.jsxs("button",{onClick:()=>r(!i),className:"group relative px-6 py-3 font-mono text-xs tracking-widest text-cyber-text border border-cyan-900/50 hover:border-cyan-500/50 transition-all duration-300 overflow-hidden cursor-pointer","aria-label":"Share article",children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-950/20 to-purple-950/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),f.jsxs("div",{className:"relative flex items-center gap-2",children:[f.jsx(Ns,{className:"w-4 h-4"}),f.jsx("span",{children:"SHARE"})]})]}),f.jsx(Qe,{children:i&&f.jsxs(q.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute bottom-full mb-2 right-0 w-56 bg-cyber-black/95 backdrop-blur-xl border border-cyan-900/50 shadow-2xl shadow-cyan-500/10 z-50",children:[f.jsx("div",{className:"p-2 space-y-1",children:c.map((h,d)=>f.jsxs(q.button,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:d*.05},onClick:h.onClick,className:"w-full group relative px-4 py-3 font-mono text-xs text-left text-cyber-text hover:bg-cyan-950/30 transition-all duration-200 flex items-center gap-3 cursor-pointer border border-transparent hover:border-cyan-900/50",children:[f.jsx(h.icon,{className:`w-4 h-4 ${h.color} transition-transform duration-200 group-hover:scale-110`}),f.jsx("span",{className:"group-hover:text-cyan-400 transition-colors duration-200",children:h.name==="Copy Link"&&n?"COPIED!":h.name.toUpperCase()})]},h.name))}),f.jsx("div",{className:"absolute -bottom-2 right-6 w-4 h-4 bg-cyber-black/95 border-r border-b border-cyan-900/50 transform rotate-45"})]})}),f.jsx(Qe,{children:n&&f.jsx(q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"fixed bottom-8 left-1/2 transform -translate-x-1/2 px-6 py-3 bg-cyan-950/90 backdrop-blur-xl border border-cyan-500/50 font-mono text-xs text-cyan-400 shadow-2xl shadow-cyan-500/20 z-[100]",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(dt,{className:"w-4 h-4"}),f.jsx("span",{children:"LINK COPIED TO CLIPBOARD"})]})})})]})},Nn=({post:t,onClose:e,articleIndex:s})=>{const[i,r]=D.useState(!1);if(D.useEffect(()=>{if(t){r(!1);const a=setTimeout(()=>r(!0),1e3);return()=>clearTimeout(a)}},[t]),!t)return null;const n=t.title.replace(/_/g," ");return ss.createPortal(f.jsx(Qe,{children:t&&f.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center p-0 md:p-8 bg-cyber-black/90 md:backdrop-blur-md",onClick:e,children:f.jsxs(q.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"bg-cyber-black border border-cyber-white w-full max-w-4xl h-full md:h-auto md:max-h-[90vh] overflow-y-auto shadow-2xl relative flex flex-col no-scrollbar",onClick:a=>a.stopPropagation(),"data-lenis-prevent":!0,children:[f.jsxs("div",{className:"sticky top-0 z-20 bg-cyber-black border-b border-cyber-white flex justify-between items-center px-6 py-4",children:[f.jsxs("div",{className:"font-mono text-xs text-cyber-white",children:["READING_MODE // ",(s||0).toString().padStart(3,"0")]}),f.jsx("button",{onClick:e,className:"p-1 hover:bg-cyber-white hover:text-cyber-black transition-colors","aria-label":"Close",children:f.jsx(is,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"p-8 md:p-16",children:[f.jsxs("div",{className:"flex flex-row justify-between items-end gap-4 mb-8 border-b border-cyber-border pb-6",children:[f.jsx(q.div,{initial:{opacity:0,filter:"blur(5px)"},animate:i?{opacity:1,filter:"blur(0px)"}:{opacity:0,filter:"blur(5px)"},transition:{duration:1,delay:.2},className:"shrink-0",children:f.jsxs(rs,{to:"/about",className:"group flex items-center gap-4 no-underline flex-row-reverse",children:[f.jsxs("div",{className:"flex flex-col items-start",children:[f.jsx("span",{className:"text-xs md:text-sm font-display font-bold text-cyber-white group-hover:text-cyan-400 transition-colors text-left tracking-wide",children:"Okuhle Madondo"}),f.jsx("span",{className:"text-[9px] md:text-[10px] font-mono text-cyber-text tracking-widest text-left",children:"AUTHOR // ARCHITECT"})]}),f.jsxs("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full bg-cyber-dark border border-cyber-border overflow-hidden relative group-hover:border-cyber-white transition-colors shrink-0",children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyber-border to-transparent opacity-50"}),f.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-[10px] font-mono text-cyber-text",children:"OM"})]})]})}),f.jsxs("div",{className:"font-mono text-[10px] md:text-xs text-cyber-text w-auto text-right",children:[f.jsxs("div",{className:"md:hidden flex flex-col gap-1 items-end text-[9px]",children:[f.jsx("div",{className:"whitespace-nowrap",children:f.jsx(Ee,{text:`CAT: ${t.category}`,animateOn:"view",speed:50,sequential:!0,className:"inline-block"})}),f.jsx("div",{className:"whitespace-nowrap",children:f.jsx(Ee,{text:`DATE: ${t.date}`,animateOn:"view",speed:50,sequential:!0,className:"inline-block",startDelay:500})}),f.jsx("div",{className:"whitespace-nowrap",children:f.jsx(Ee,{text:`TIME: ${t.readTime}`,animateOn:"view",speed:50,sequential:!0,className:"inline-block",startDelay:1e3})})]}),f.jsx("div",{className:"hidden md:block mb-3",children:f.jsx(Ee,{text:`CAT: ${t.category} // DATE: ${t.date} // TIME: ${t.readTime}`,animateOn:"view",speed:50,sequential:!0,className:"inline-block"})})]})]}),t.audioTrack&&f.jsxs("div",{className:"mb-12 p-4 border border-cyber-border bg-cyber-dark/50 flex items-center gap-4",children:[f.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-full border border-cyber-white text-cyber-white hover:bg-cyber-white hover:text-cyber-black transition-all",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:f.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"text-xs font-mono text-cyber-text mb-1",children:["AUDIO_TRACK // ",t.title]}),f.jsx("div",{className:"h-1 w-full bg-cyber-black border border-cyber-border relative",children:f.jsx("div",{className:"absolute top-0 left-0 h-full w-1/3 bg-cyber-white/50"})})]}),f.jsx("div",{className:"font-mono text-xs text-cyber-white",children:"00:00 / 12:45"})]}),f.jsx("h2",{className:"text-4xl md:text-6xl font-bold mb-8 leading-none tracking-tighter uppercase min-h-[1.2em] break-words hyphens-auto",children:f.jsx(Ie,{start:!0,delay:.2,children:n})}),f.jsx(q.div,{initial:{opacity:0,y:40,filter:"blur(10px)"},animate:i?{opacity:1,y:0,filter:"blur(0px)"}:{opacity:0,y:40,filter:"blur(10px)"},transition:{duration:1.2,ease:[.16,1,.3,1]},className:"prose prose-invert prose-base md:prose-lg max-w-none font-sans text-cyber-text",children:t.component?f.jsx(t.component,{}):f.jsxs(f.Fragment,{children:[f.jsx("p",{className:"lead text-xl text-cyber-white mb-8 font-mono border-l-4 border-cyber-white pl-6",children:t.excerpt}),f.jsx("p",{children:t.content}),f.jsx("p",{children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."}),f.jsx("p",{children:"Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."})]})}),f.jsxs(q.div,{initial:{opacity:0},animate:i?{opacity:1}:{opacity:0},transition:{duration:.8,delay:.4},className:"mt-16 pt-8 border-t border-cyber-border flex justify-between items-center",children:[f.jsx("div",{className:"flex gap-4",children:f.jsx(Mn,{url:`${window.location.origin}/${t.category.toLowerCase()}/${t.slug}`,title:t.title,description:t.excerpt})}),f.jsx(Fs,{className:"w-5 h-5 text-cyber-text"})]})]})]})})}),document.body)},Fn=({title:t,index:e,sector:s,color:i="text-cyber-white",borderColor:r="border-cyber-border"})=>f.jsxs("div",{className:`flex flex-row items-end justify-between mb-12 md:mb-16 border-b ${r} pb-4 relative overflow-hidden gap-2 md:gap-0`,children:[f.jsx(q.div,{initial:{width:"0%"},whileInView:{width:"100%"},viewport:{once:!1},transition:{duration:.8,ease:"easeInOut",delay:0},className:`absolute bottom-0 left-0 h-[1px] ${r.replace("border-","bg-")}`}),f.jsxs(q.h2,{className:`text-lg md:text-2xl font-mono font-bold tracking-tighter ${i} flex items-center shrink-0`,initial:"hidden",whileInView:"visible",viewport:{once:!1},variants:{hidden:{opacity:0,x:-20,transition:{duration:.1}},visible:{opacity:1,x:0,transition:{delay:.2,duration:.5}}},children:[f.jsx("span",{className:"mr-2 md:mr-4 opacity-50",children:"//"}),f.jsx(Ee,{text:t,animateOn:"view",speed:100,sequential:!0,className:"inline-block"})]}),f.jsxs(q.div,{className:`font-mono text-[10px] md:text-xs ${i} opacity-60 text-right`,initial:"hidden",whileInView:"visible",viewport:{once:!1},variants:{hidden:{opacity:0,x:20,transition:{duration:.1}},visible:{opacity:.6,x:0,transition:{delay:.8,duration:.5}}},children:[f.jsxs("span",{className:"block md:inline",children:["INDEX: ",e.toString().padStart(3,"0")]}),f.jsx("span",{className:"hidden md:inline",children:" // "}),f.jsxs("span",{className:"block md:inline",children:["SECTOR: ",s]})]})]});export{Dn as H,zn as P,Nn as R,Fn as S};
